/*! For license information please see 232.546abf56.chunk.js.LICENSE.txt */
(self.webpackChunk_3d_examples=self.webpackChunk_3d_examples||[]).push([[232],{7228:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},2858:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3646:function(t,e,n){var r=n(7228);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},1506:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},4575:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},9100:function(t,e,n){var r=n(9489),i=n(7067);function o(e,n,a){return i()?(t.exports=o=Reflect.construct,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},t.exports.__esModule=!0,t.exports.default=t.exports),o.apply(null,arguments)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},3913:function(t){function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},3269:function(t,e,n){var r=n(379);t.exports=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}},t.exports.__esModule=!0,t.exports.default=t.exports},9842:function(t,e,n){var r=n(9754),i=n(7067),o=n(8585);t.exports=function(t){var e=i();return function(){var n,i=r(t);if(e){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}},t.exports.__esModule=!0,t.exports.default=t.exports},9713:function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},6525:function(t,e,n){var r=n(8331);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(t.exports=i=Reflect.get,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},9754:function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},2205:function(t,e,n){var r=n(9489);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},7067:function(t){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},6860:function(t){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},3884:function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},521:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},8206:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},8585:function(t,e,n){var r=n(8).default,i=n(1506);t.exports=function(t,e){if(e&&("object"===r(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},9489:function(t){function e(n,r){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},3038:function(t,e,n){var r=n(2858),i=n(3884),o=n(379),a=n(521);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},8331:function(t,e,n){var r=n(9754);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},319:function(t,e,n){var r=n(3646),i=n(6860),o=n(379),a=n(8206);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},8:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},379:function(t,e,n){var r=n(7228);t.exports=function(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},5467:function(t,e,n){t.exports=n(8251)},4324:function(t){"use strict";var e=!("undefined"===typeof window||!window.document||!window.document.createElement),n={canUseDOM:e,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:e&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:e&&!!window.screen,isInWorker:!e};t.exports=n},7009:function(t){var e,n,r,i,o,a,s,l,u,c,p,d,h,v,f,m=!1;function b(){if(!m){m=!0;var t=navigator.userAgent,b=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),_=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(d=/\b(iPhone|iP[ao]d)/.exec(t),h=/\b(iP[ao]d)/.exec(t),c=/Android/i.exec(t),v=/FBAN\/\w+;/i.exec(t),f=/Mobile/i.exec(t),p=!!/Win64/.exec(t),b){(e=b[1]?parseFloat(b[1]):b[5]?parseFloat(b[5]):NaN)&&document&&document.documentMode&&(e=document.documentMode);var g=/(?:Trident\/(\d+.\d+))/.exec(t);a=g?parseFloat(g[1])+4:e,n=b[2]?parseFloat(b[2]):NaN,r=b[3]?parseFloat(b[3]):NaN,(i=b[4]?parseFloat(b[4]):NaN)?(b=/(?:Chrome\/(\d+\.\d+))/.exec(t),o=b&&b[1]?parseFloat(b[1]):NaN):o=NaN}else e=n=r=o=i=NaN;if(_){if(_[1]){var w=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);s=!w||parseFloat(w[1].replace("_","."))}else s=!1;l=!!_[2],u=!!_[3]}else s=l=u=!1}}var _={ie:function(){return b()||e},ieCompatibilityMode:function(){return b()||a>e},ie64:function(){return _.ie()&&p},firefox:function(){return b()||n},opera:function(){return b()||r},webkit:function(){return b()||i},safari:function(){return _.webkit()},chrome:function(){return b()||o},windows:function(){return b()||l},osx:function(){return b()||s},linux:function(){return b()||u},iphone:function(){return b()||d},mobile:function(){return b()||d||h||c||f},nativeApp:function(){return b()||v},android:function(){return b()||c},ipad:function(){return b()||h}};t.exports=_},6024:function(t,e,n){"use strict";var r,i=n(4324);i.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),t.exports=function(t,e){if(!i.canUseDOM||e&&!("addEventListener"in document))return!1;var n="on"+t,o=n in document;if(!o){var a=document.createElement("div");a.setAttribute(n,"return;"),o="function"===typeof a[n]}return!o&&r&&"wheel"===t&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}},8251:function(t,e,n){"use strict";var r=n(7009),i=n(6024);function o(t){var e=0,n=0,r=0,i=0;return"detail"in t&&(n=t.detail),"wheelDelta"in t&&(n=-t.wheelDelta/120),"wheelDeltaY"in t&&(n=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=n,n=0),r=10*e,i=10*n,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(r=t.deltaX),(r||i)&&t.deltaMode&&(1==t.deltaMode?(r*=40,i*=40):(r*=800,i*=800)),r&&!e&&(e=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:e,spinY:n,pixelX:r,pixelY:i}}o.getEventType=function(){return r.firefox()?"DOMMouseScroll":i("wheel")?"wheel":"mousewheel"},t.exports=o},1001:function(t){t.exports=function(){var t=function t(){function e(t){return i.appendChild(t.dom),t}function n(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";r=t}var r=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),n(++r%i.children.length)}),!1);var o=(performance||Date).now(),a=o,s=0,l=e(new t.Panel("FPS","#0ff","#002")),u=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:i,addPanel:e,showPanel:n,begin:function(){o=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(u.update(t-o,200),t>a+1e3&&(l.update(1e3*s/(t-a),100),a=t,s=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:i,setMode:n}};return t.Panel=function(t,e,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,l=48*a,u=3*a,c=2*a,p=3*a,d=15*a,h=74*a,v=30*a,f=document.createElement("canvas");f.width=s,f.height=l,f.style.cssText="width:80px;height:48px";var m=f.getContext("2d");return m.font="bold "+9*a+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=n,m.fillRect(0,0,s,l),m.fillStyle=e,m.fillText(t,u,c),m.fillRect(p,d,h,v),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(p,d,h,v),{dom:f,update:function(l,b){r=Math.min(r,l),i=Math.max(i,l),m.fillStyle=n,m.globalAlpha=1,m.fillRect(0,0,s,d),m.fillStyle=e,m.fillText(o(l)+" "+t+" ("+o(r)+"-"+o(i)+")",u,c),m.drawImage(f,p+a,d,h-a,v,p,d,h-a,v),m.fillRect(p+h-a,d,a,v),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(p+h-a,d,a,o((1-l/b)*v))}}},t}()},850:function(t,e,n){"use strict";function r(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function i(t){for(var e={},n=0;n<t.length;n++){var i=r(t[n]);for(var o in i)e[o]=i[o]}return e}n.d(e,{Rh:function(){return i}})},4427:function(t,e,n){var r=n(6525).default,i=n(9754).default,o=n(9100).default,a=n(3269).default,s=n(1506).default,l=n(319).default,u=n(9713).default,c=n(2205).default,p=n(9842).default,d=n(3038).default,h=n(4575).default,v=n(3913).default;!function(t){"use strict";var e=function(){function t(e){h(this,t);var n=e.split("-"),r=d(n,2),i=r[0],o=r[1],a=i.split(".");this.major=parseInt(a[0],10),this.minor=parseInt(a[1],10),this.patch=parseInt(a[2],10),this.prerelease=null!==o&&void 0!==o?o:null}return v(t,[{key:"toString",value:function(){var t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}]),t}(),n=function(){function t(e){h(this,t),this.controller_=e}return v(t,[{key:"element",get:function(){return this.controller_.view.element}},{key:"disabled",get:function(){return this.controller_.viewProps.get("disabled")},set:function(t){this.controller_.viewProps.set("disabled",t)}},{key:"hidden",get:function(){return this.controller_.viewProps.get("hidden")},set:function(t){this.controller_.viewProps.set("hidden",t)}},{key:"dispose",value:function(){this.controller_.viewProps.set("disposed",!0)}}]),t}(),f=v((function t(e){h(this,t),this.target=e})),m=function(t){c(n,t);var e=p(n);function n(t,r,i,o){var a;return h(this,n),(a=e.call(this,t)).value=r,a.presetKey=i,a.last=null===o||void 0===o||o,a}return v(n)}(f),b=function(t){c(n,t);var e=p(n);function n(t,r,i){var o;return h(this,n),(o=e.call(this,t)).value=r,o.presetKey=i,o}return v(n)}(f),_=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t)).expanded=r,i}return v(n)}(f),g=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t)).index=r,i}return v(n)}(f);function w(t){return t}function y(t){return null===t||void 0===t}function x(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function k(t,e){var n=t;do{var r=Object.getOwnPropertyDescriptor(n,e);if(r&&(void 0!==r.set||!0===r.writable))return!0;n=Object.getPrototypeOf(n)}while(null!==n);return!1}var C={alreadydisposed:function(){return"View has been already disposed"},invalidparams:function(t){return"Invalid parameters for '".concat(t.name,"'")},nomatchingcontroller:function(t){return"No matching controller for '".concat(t.key,"'")},nomatchingview:function(t){return"No matching view for '".concat(JSON.stringify(t.params),"'")},notbindable:function(){return"Value is not bindable"},propertynotfound:function(t){return"Property '".concat(t.name,"' not found")},shouldneverhappen:function(){return"This error should never happen"}},P=function(){function t(e){var n;h(this,t),this.message=null!==(n=C[e.type](w(e.context)))&&void 0!==n?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}return v(t,null,[{key:"alreadyDisposed",value:function(){return new t({type:"alreadydisposed"})}},{key:"notBindable",value:function(){return new t({type:"notbindable"})}},{key:"propertyNotFound",value:function(e){return new t({type:"propertynotfound",context:{name:e}})}},{key:"shouldNeverHappen",value:function(){return new t({type:"shouldneverhappen"})}}]),t}(),E=function(){function t(e,n,r){h(this,t),this.obj_=e,this.key_=n,this.presetKey_=null!==r&&void 0!==r?r:n}return v(t,[{key:"key",get:function(){return this.key_}},{key:"presetKey",get:function(){return this.presetKey_}},{key:"read",value:function(){return this.obj_[this.key_]}},{key:"write",value:function(t){this.obj_[this.key_]=t}},{key:"writeProperty",value:function(e,n){var r=this.read();if(!t.isBindable(r))throw P.notBindable();if(!(e in r))throw P.propertyNotFound(e);r[e]=n}}],[{key:"isBindable",value:function(t){return null!==t&&("object"===typeof t||"function"===typeof t)}}]),t}(),V=function(t){c(n,t);var e=p(n);function n(){return h(this,n),e.apply(this,arguments)}return v(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"title",get:function(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.valueController.props.set("title",t)}},{key:"on",value:function(t,e){var n=this,r=e.bind(this);return this.controller_.valueController.emitter.on(t,(function(){r(new f(n))})),this}}]),n}(n),S=function(){function t(){h(this,t),this.observers_={}}return v(t,[{key:"on",value:function(t,e){var n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}},{key:"off",value:function(t,e){var n=this.observers_[t];return n&&(this.observers_[t]=n.filter((function(t){return t.handler!==e}))),this}},{key:"emit",value:function(t,e){var n=this.observers_[t];n&&n.forEach((function(t){t.handler(e)}))}}]),t}(),A="tp";function T(t){return function(e,n){return[A,"-",t,"v",e?"_".concat(e):"",n?"-".concat(n):""].join("")}}function D(t,e){return function(n){return e(t(n))}}function L(t){return t.rawValue}function M(t,e){t.emitter.on("change",D(L,e)),e(t.rawValue)}function R(t,e,n){M(t.value(e),n)}function B(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function U(t,e){return function(n){B(t,e,n)}}function F(t,e){M(t,(function(t){e.textContent=null!==t&&void 0!==t?t:""}))}var I=T("btn"),O=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(I()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("button");r.classList.add(I("b")),n.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;var i=e.createElement("div");i.classList.add(I("t")),F(n.props.value("title"),i),this.buttonElement.appendChild(i)})),j=function(){function t(e,n){h(this,t),this.emitter=new S,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new O(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return v(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),N=function(){function t(e,n){var r;h(this,t),this.constraint_=null===n||void 0===n?void 0:n.constraint,this.equals_=null!==(r=null===n||void 0===n?void 0:n.equals)&&void 0!==r?r:function(t,e){return t===e},this.emitter=new S,this.rawValue_=e}return v(t,[{key:"constraint",get:function(){return this.constraint_}},{key:"rawValue",get:function(){return this.rawValue_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!==e&&void 0!==e?e:{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(t):t,i=this.rawValue_;(!this.equals_(i,r)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:r,sender:this}))}}]),t}(),K=function(){function t(e){h(this,t),this.emitter=new S,this.value_=e}return v(t,[{key:"rawValue",get:function(){return this.value_},set:function(t){this.setRawValue(t,{forceEmit:!1,last:!0})}},{key:"setRawValue",value:function(t,e){var n=null!==e&&void 0!==e?e:{forceEmit:!1,last:!0},r=this.value_;(r!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:this.value_,sender:this}))}}]),t}();function G(t,e){var n=null===e||void 0===e?void 0:e.constraint,r=null===e||void 0===e?void 0:e.equals;return n||r?new N(t,e):new K(t)}var H=function(){function t(e){var n=this;h(this,t),this.emitter=new S,this.valMap_=e;var r=function(t){n.valMap_[t].emitter.on("change",(function(){n.emitter.emit("change",{key:t,sender:n})}))};for(var i in this.valMap_)r(i)}return v(t,[{key:"get",value:function(t){return this.valMap_[t].rawValue}},{key:"set",value:function(t,e){this.valMap_[t].rawValue=e}},{key:"value",value:function(t){return this.valMap_[t]}}],[{key:"createCore",value:function(t){return Object.keys(t).reduce((function(e,n){return Object.assign(e,u({},n,G(t[n])))}),{})}},{key:"fromObject",value:function(e){return new t(this.createCore(e))}}]),t}();function z(t,e){return w(Object.keys(e).reduce((function(n,r){if(void 0!==n){var i=(0,e[r])(t[r]);return i.succeeded?Object.assign(Object.assign({},n),u({},r,i.value)):void 0}}),{}))}function q(t,e){return t.reduce((function(t,n){if(void 0!==t){var r=e(n);if(r.succeeded&&void 0!==r.value)return[].concat(l(t),[r.value])}}),[])}function Z(t){return null!==t&&"object"===typeof t}function W(t){return function(e){return function(n){if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};var r=t(n);return void 0!==r?{succeeded:!0,value:r}:{succeeded:!1,value:void 0}}}}function Y(t){return{custom:function(e){return W(e)(t)},boolean:W((function(t){return"boolean"===typeof t?t:void 0}))(t),number:W((function(t){return"number"===typeof t?t:void 0}))(t),string:W((function(t){return"string"===typeof t?t:void 0}))(t),function:W((function(t){return"function"===typeof t?t:void 0}))(t),constant:function(e){return W((function(t){return t===e?e:void 0}))(t)},raw:W((function(t){return t}))(t),object:function(e){return W((function(t){if(Z(t))return z(t,e)}))(t)},array:function(e){return W((function(t){if(Array.isArray(t))return q(t,e)}))(t)}}}var X={optional:Y(!0),required:Y(!1)};function $(t,e){var n=X.required.object(e)(t);return n.succeeded?n.value:void 0}function Q(t){console.warn(["Missing '".concat(t.key,"' of ").concat(t.target," in ").concat(t.place,"."),"Please rebuild plugins with the latest core package."].join(" "))}function J(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}var tt=function(){function t(e){h(this,t),this.value_=e}return v(t,[{key:"emitter",get:function(){return this.value_.emitter}},{key:"rawValue",get:function(){return this.value_.rawValue}}],[{key:"create",value:function(e){return[new t(e),function(t,n){e.setRawValue(t,n)}]}}]),t}(),et=T("");function nt(t,e){return U(t,et(void 0,e))}var rt=function(t){c(n,t);var e=p(n);function n(t){var r,i;h(this,n),(r=e.call(this,t)).onDisabledChange_=r.onDisabledChange_.bind(s(r)),r.onParentChange_=r.onParentChange_.bind(s(r)),r.onParentGlobalDisabledChange_=r.onParentGlobalDisabledChange_.bind(s(r));var o=tt.create(G(r.getGlobalDisabled_())),a=d(o,2);return r.globalDisabled_=a[0],r.setGlobalDisabled_=a[1],r.value("disabled").emitter.on("change",r.onDisabledChange_),r.value("parent").emitter.on("change",r.onParentChange_),null===(i=r.get("parent"))||void 0===i||i.globalDisabled.emitter.on("change",r.onParentGlobalDisabledChange_),r}return v(n,[{key:"globalDisabled",get:function(){return this.globalDisabled_}},{key:"bindClassModifiers",value:function(t){M(this.globalDisabled_,nt(t,"disabled")),R(this,"hidden",nt(t,"hidden"))}},{key:"bindDisabled",value:function(t){M(this.globalDisabled_,(function(e){t.disabled=e}))}},{key:"bindTabIndex",value:function(t){M(this.globalDisabled_,(function(e){t.tabIndex=e?-1:0}))}},{key:"handleDispose",value:function(t){this.value("disposed").emitter.on("change",(function(e){e&&t()}))}},{key:"getGlobalDisabled_",value:function(){var t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}},{key:"updateGlobalDisabled_",value:function(){this.setGlobalDisabled_(this.getGlobalDisabled_())}},{key:"onDisabledChange_",value:function(){this.updateGlobalDisabled_()}},{key:"onParentGlobalDisabledChange_",value:function(){this.updateGlobalDisabled_()}},{key:"onParentChange_",value:function(t){var e,n=t.previousRawValue;null===n||void 0===n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}],[{key:"create",value:function(t){var e,r,i,o=null!==t&&void 0!==t?t:{};return new n(H.createCore({disabled:null!==(e=o.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(r=o.hidden)&&void 0!==r&&r,parent:null!==(i=o.parent)&&void 0!==i?i:null}))}}]),n}(H);function it(){return["veryfirst","first","last","verylast"]}var ot=T(""),at={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"},st=function(){function t(e){var n=this;h(this,t),this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;var r=this.view.element;this.blade.value("positions").emitter.on("change",(function(){it().forEach((function(t){r.classList.remove(ot(void 0,at[t]))})),n.blade.get("positions").forEach((function(t){r.classList.add(ot(void 0,at[t]))}))})),this.viewProps.handleDispose((function(){J(r)}))}return v(t,[{key:"parent",get:function(){return this.parent_},set:function(t){this.parent_=t,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):Q({key:"parent",target:rt.name,place:"BladeController.parent"})}}]),t}(),lt="http://www.w3.org/2000/svg";function ut(t){t.offsetHeight}function ct(t,e){var n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function pt(t){return void 0!==t.ontouchstart}function dt(){return globalThis}function ht(){return w(dt()).document}function vt(t){var e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d",{willReadFrequently:!0}):null}var ft={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function mt(t,e){var n=t.createElementNS(lt,"svg");return n.innerHTML=ft[e],n}function bt(t,e,n){t.insertBefore(e,t.children[n])}function _t(t){t.parentElement&&t.parentElement.removeChild(t)}function gt(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function wt(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function yt(t){return t.relatedTarget?w(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}var xt=T("lbl");function kt(t,e){var n=t.createDocumentFragment();return e.split("\n").map((function(e){return t.createTextNode(e)})).forEach((function(e,r){r>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}var Ct=v((function t(e,n){var r=this;h(this,t),this.element=e.createElement("div"),this.element.classList.add(xt()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(xt("l")),R(n.props,"label",(function(t){y(t)?r.element.classList.add(xt(void 0,"nol")):(r.element.classList.remove(xt(void 0,"nol")),wt(i),i.appendChild(kt(e,t)))})),this.element.appendChild(i),this.labelElement=i;var o=e.createElement("div");o.classList.add(xt("v")),this.element.appendChild(o),this.valueElement=o})),Pt=function(t){c(n,t);var e=p(n);function n(t,r){var i;h(this,n);var o=r.valueController.viewProps;return(i=e.call(this,Object.assign(Object.assign({},r),{view:new Ct(t,{props:r.props,viewProps:o}),viewProps:o}))).props=r.props,i.valueController=r.valueController,i.view.valueElement.appendChild(i.valueController.view.element),i}return v(n)}(st),Et={id:"button",type:"blade",accept:function(t){var e=X,n=$(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:function(t){return new Pt(t.document,{blade:t.blade,props:H.fromObject({label:t.params.label}),valueController:new j(t.document,{props:H.fromObject({title:t.params.title}),viewProps:t.viewProps})})},api:function(t){return t.controller instanceof Pt&&t.controller.valueController instanceof j?new V(t.controller):null}},Vt=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,t)).value=t.value,r}return v(n)}(st);function St(){return new H({positions:G([],{equals:x})})}var At=function(t){c(n,t);var e=p(n);function n(t){return h(this,n),e.call(this,t)}return v(n,[{key:"styleExpanded",get:function(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}},{key:"styleHeight",get:function(){if(!this.styleExpanded)return"0";var t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!y(t)?"".concat(t,"px"):"auto"}},{key:"bindExpandedClass",value:function(t,e){var n=this,r=function(){n.styleExpanded?t.classList.add(e):t.classList.remove(e)};R(this,"expanded",r),R(this,"temporaryExpanded",r)}},{key:"cleanUpTransition",value:function(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}],[{key:"create",value:function(t){var e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null};return new n(H.createCore(e))}}]),n}(H);function Tt(t,e){var n=0;return ct(e,(function(){t.set("expandedHeight",null),t.set("temporaryExpanded",!0),ut(e),n=e.clientHeight,t.set("temporaryExpanded",null),ut(e)})),n}function Dt(t,e){e.style.height=t.styleHeight}function Lt(t,e){t.value("expanded").emitter.on("beforechange",(function(){if(t.set("completed",!1),y(t.get("expandedHeight"))){var n=Tt(t,e);n>0&&t.set("expandedHeight",n)}t.set("shouldFixHeight",!0),ut(e)})),t.emitter.on("change",(function(){Dt(t,e)})),Dt(t,e),e.addEventListener("transitionend",(function(e){"height"===e.propertyName&&t.cleanUpTransition()}))}var Mt=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t)).rackApi_=r,i}return v(n)}(n);function Rt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function Bt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Ut(t,e){var n=null!==e&&void 0!==e?e:{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}function Ft(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}var It=function(){function t(e){h(this,t),this.emitter=new S,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}return v(t,[{key:"items",get:function(){return this.items_}},{key:"allItems",value:function(){return Array.from(this.cache_)}},{key:"find",value:function(t){var e,n=a(this.allItems());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(t(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"includes",value:function(t){return this.cache_.has(t)}},{key:"add",value:function(t,e){var n=this;if(this.includes(t))throw P.shouldNeverHappen();var r=void 0!==e?e:this.items_.length;this.items_.splice(r,0,t),this.cache_.add(t);var i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((function(t){n.cache_.add(t)}))),this.emitter.emit("add",{index:r,item:t,root:this,target:this})}},{key:"remove",value:function(t){var e=this.items_.indexOf(t);if(!(e<0)){this.items_.splice(e,1),this.cache_.delete(t);var n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}}},{key:"onSubListAdd_",value:function(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}},{key:"onSubListRemove_",value:function(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}]),t}(),Ot=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,t)).onBindingChange_=r.onBindingChange_.bind(s(r)),r.emitter_=new S,r.controller_.binding.emitter.on("change",r.onBindingChange_),r}return v(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"refresh",value:function(){this.controller_.binding.read()}},{key:"onBindingChange_",value:function(t){var e=t.sender.target.read();this.emitter_.emit("change",{event:new m(this,w(e),this.controller_.binding.target.presetKey,t.options.last)})}}]),n}(n),jt=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t,r)).binding=r.binding,i}return v(n)}(Pt),Nt=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,t)).onBindingUpdate_=r.onBindingUpdate_.bind(s(r)),r.emitter_=new S,r.controller_.binding.emitter.on("update",r.onBindingUpdate_),r}return v(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"refresh",value:function(){this.controller_.binding.read()}},{key:"onBindingUpdate_",value:function(t){var e=t.sender.target.read();this.emitter_.emit("update",{event:new b(this,w(e),this.controller_.binding.target.presetKey)})}}]),n}(n),Kt=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t,r)).binding=r.binding,i.viewProps.bindDisabled(i.binding.ticker),i.viewProps.handleDispose((function(){i.binding.dispose()})),i}return v(n)}(Pt);function Gt(t){return t instanceof qt?t.apiSet_:t instanceof Mt?t.rackApi_.apiSet_:null}function Ht(t,e){var n=t.find((function(t){return t.controller_===e}));if(!n)throw P.shouldNeverHappen();return n}function zt(t,e,n){if(!E.isBindable(t))throw P.notBindable();return new E(t,e,n)}var qt=function(t){c(n,t);var e=p(n);function n(t,r){var i;h(this,n),(i=e.call(this,t)).onRackAdd_=i.onRackAdd_.bind(s(i)),i.onRackRemove_=i.onRackRemove_.bind(s(i)),i.onRackInputChange_=i.onRackInputChange_.bind(s(i)),i.onRackMonitorUpdate_=i.onRackMonitorUpdate_.bind(s(i)),i.emitter_=new S,i.apiSet_=new It(Gt),i.pool_=r;var o=i.controller_.rack;return o.emitter.on("add",i.onRackAdd_),o.emitter.on("remove",i.onRackRemove_),o.emitter.on("inputchange",i.onRackInputChange_),o.emitter.on("monitorupdate",i.onRackMonitorUpdate_),o.children.forEach((function(t){i.setUpApi_(t)})),i}return v(n,[{key:"children",get:function(){var t=this;return this.controller_.rack.children.map((function(e){return Ht(t.apiSet_,e)}))}},{key:"addInput",value:function(t,e,n){var r=null!==n&&void 0!==n?n:{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(i,zt(t,e,r.presetKey),r),a=new Ot(o);return this.add(a,r.index)}},{key:"addMonitor",value:function(t,e,n){var r=null!==n&&void 0!==n?n:{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(i,zt(t,e),r),a=new Nt(o);return w(this.add(a,r.index))}},{key:"addFolder",value:function(t){return Bt(this,t)}},{key:"addButton",value:function(t){return Rt(this,t)}},{key:"addSeparator",value:function(t){return Ut(this,t)}},{key:"addTab",value:function(t){return Ft(this,t)}},{key:"add",value:function(t,e){this.controller_.rack.add(t.controller_,e);var n=this.apiSet_.find((function(e){return e.controller_===t.controller_}));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}},{key:"remove",value:function(t){this.controller_.rack.remove(t.controller_)}},{key:"addBlade",value:function(t){var e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),r=this.pool_.createBladeApi(n);return this.add(r,t.index)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"setUpApi_",value:function(t){this.apiSet_.find((function(e){return e.controller_===t}))||this.apiSet_.add(this.pool_.createBladeApi(t))}},{key:"onRackAdd_",value:function(t){this.setUpApi_(t.bladeController)}},{key:"onRackRemove_",value:function(t){if(t.isRoot){var e=Ht(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}},{key:"onRackInputChange_",value:function(t){var e=t.bladeController;if(e instanceof jt){var n=Ht(this.apiSet_,e),r=e.binding;this.emitter_.emit("change",{event:new m(n,w(r.target.read()),r.target.presetKey,t.options.last)})}else if(e instanceof Vt){var i=Ht(this.apiSet_,e);this.emitter_.emit("change",{event:new m(i,e.value.rawValue,void 0,t.options.last)})}}},{key:"onRackMonitorUpdate_",value:function(t){if(!(t.bladeController instanceof Kt))throw P.shouldNeverHappen();var e=Ht(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new b(e,w(n.target.read()),n.target.presetKey)})}}]),n}(n),Zt=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t,new qt(t.rackController,r))).emitter_=new S,i.controller_.foldable.value("expanded").emitter.on("change",(function(t){i.emitter_.emit("fold",{event:new _(s(i),t.sender.rawValue)})})),i.rackApi_.on("change",(function(t){i.emitter_.emit("change",{event:t})})),i.rackApi_.on("update",(function(t){i.emitter_.emit("update",{event:t})})),i}return v(n,[{key:"expanded",get:function(){return this.controller_.foldable.get("expanded")},set:function(t){this.controller_.foldable.set("expanded",t)}},{key:"title",get:function(){return this.controller_.props.get("title")},set:function(t){this.controller_.props.set("title",t)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addInput",value:function(t,e,n){return this.rackApi_.addInput(t,e,n)}},{key:"addMonitor",value:function(t,e,n){return this.rackApi_.addMonitor(t,e,n)}},{key:"addFolder",value:function(t){return this.rackApi_.addFolder(t)}},{key:"addButton",value:function(t){return this.rackApi_.addButton(t)}},{key:"addSeparator",value:function(t){return this.rackApi_.addSeparator(t)}},{key:"addTab",value:function(t){return this.rackApi_.addTab(t)}},{key:"add",value:function(t,e){return this.rackApi_.add(t,e)}},{key:"remove",value:function(t){this.rackApi_.remove(t)}},{key:"addBlade",value:function(t){return this.rackApi_.addBlade(t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(Mt),Wt=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,{blade:t.blade,view:t.view,viewProps:t.rackController.viewProps})).rackController=t.rackController,r}return v(n)}(st),Yt=v((function t(e,n){h(this,t);var r=T(n.viewName);this.element=e.createElement("div"),this.element.classList.add(r()),n.viewProps.bindClassModifiers(this.element)}));function Xt(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r instanceof jt&&r.binding===e)return r}return null}function $t(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r instanceof Kt&&r.binding===e)return r}return null}function Qt(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r instanceof Vt&&r.value===e)return r}return null}function Jt(t){return t instanceof ne?t.rack:t instanceof Wt?t.rackController.rack:null}function te(t){var e=Jt(t);return e?e.bcSet_:null}var ee=function(){function t(e){var n,r;h(this,t),this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new S,this.blade_=null!==(n=e.blade)&&void 0!==n?n:null,null===(r=this.blade_)||void 0===r||r.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new It(te),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}return v(t,[{key:"children",get:function(){return this.bcSet_.items}},{key:"add",value:function(t,e){var n;null===(n=t.parent)||void 0===n||n.remove(t),k(t,"parent")?t.parent=this:(t.parent_=this,Q({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(t,e)}},{key:"remove",value:function(t){k(t,"parent")?t.parent=null:(t.parent_=null,Q({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(t)}},{key:"find",value:function(t){return w(this.bcSet_.allItems().filter((function(e){return e instanceof t})))}},{key:"onSetAdd_",value:function(t){this.updatePositions_();var e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),e){var n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof jt)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof Kt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof Vt)n.value.emitter.on("change",this.onChildValueChange_);else{var r=Jt(n);if(r){var i=r.emitter;i.on("layout",this.onDescendantLayout_),i.on("inputchange",this.onDescendantInputChange_),i.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}}},{key:"onSetRemove_",value:function(t){this.updatePositions_();var e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),e){var n=t.item;if(n instanceof jt)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof Kt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof Vt)n.value.emitter.off("change",this.onChildValueChange_);else{var r=Jt(n);if(r){var i=r.emitter;i.off("layout",this.onDescendantLayout_),i.off("inputchange",this.onDescendantInputChange_),i.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}}},{key:"updatePositions_",value:function(){var t=this,e=this.bcSet_.items.filter((function(t){return!t.viewProps.get("hidden")})),n=e[0],r=e[e.length-1];this.bcSet_.items.forEach((function(e){var i=[];e===n&&(i.push("first"),t.blade_&&!t.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),e===r&&(i.push("last"),t.blade_&&!t.blade_.get("positions").includes("verylast")||i.push("verylast")),e.blade.set("positions",i)}))}},{key:"onChildPositionsChange_",value:function(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildViewPropsChange_",value:function(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onChildDispose_",value:function(){var t=this;this.bcSet_.items.filter((function(t){return t.viewProps.get("disposed")})).forEach((function(e){t.bcSet_.remove(e)}))}},{key:"onChildInputChange_",value:function(t){var e=Xt(this.find(jt),t.sender);if(!e)throw P.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}},{key:"onChildMonitorUpdate_",value:function(t){var e=$t(this.find(Kt),t.sender);if(!e)throw P.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}},{key:"onChildValueChange_",value:function(t){var e=Qt(this.find(Vt),t.sender);if(!e)throw P.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}},{key:"onDescendantLayout_",value:function(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}},{key:"onDescendantInputChange_",value:function(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}},{key:"onDescendantMonitorUpdate_",value:function(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}},{key:"onBladePositionsChange_",value:function(){this.updatePositions_()}}]),t}(),ne=function(t){c(n,t);var e=p(n);function n(t,r){var i;h(this,n),(i=e.call(this,Object.assign(Object.assign({},r),{view:new Yt(t,{viewName:"brk",viewProps:r.viewProps})}))).onRackAdd_=i.onRackAdd_.bind(s(i)),i.onRackRemove_=i.onRackRemove_.bind(s(i));var o=new ee({blade:r.root?void 0:r.blade,viewProps:r.viewProps});return o.emitter.on("add",i.onRackAdd_),o.emitter.on("remove",i.onRackRemove_),i.rack=o,i.viewProps.handleDispose((function(){for(var t=i.rack.children.length-1;t>=0;t--)i.rack.children[t].viewProps.set("disposed",!0)})),i}return v(n,[{key:"onRackAdd_",value:function(t){t.isRoot&&bt(this.view.element,t.bladeController.view.element,t.index)}},{key:"onRackRemove_",value:function(t){t.isRoot&&_t(t.bladeController.view.element)}}]),n}(st),re=T("cnt"),ie=v((function t(e,n){var r,i=this;h(this,t),this.className_=T(null!==(r=n.viewName)&&void 0!==r?r:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),re()),n.viewProps.bindClassModifiers(this.element),this.foldable_=n.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),R(this.foldable_,"completed",U(this.element,this.className_(void 0,"cpl")));var o=e.createElement("button");o.classList.add(this.className_("b")),R(n.props,"title",(function(t){y(t)?i.element.classList.add(i.className_(void 0,"not")):i.element.classList.remove(i.className_(void 0,"not"))})),n.viewProps.bindDisabled(o),this.element.appendChild(o),this.buttonElement=o;var a=e.createElement("div");a.classList.add(this.className_("i")),this.element.appendChild(a);var s=e.createElement("div");s.classList.add(this.className_("t")),F(n.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s;var l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);var u=n.containerElement;u.classList.add(this.className_("c")),this.element.appendChild(u),this.containerElement=u})),oe=function(t){c(n,t);var e=p(n);function n(t,r){var i,o;h(this,n);var a=At.create(null===(o=r.expanded)||void 0===o||o),l=new ne(t,{blade:r.blade,root:r.root,viewProps:r.viewProps});return(i=e.call(this,Object.assign(Object.assign({},r),{rackController:l,view:new ie(t,{containerElement:l.view.element,foldable:a,props:r.props,viewName:r.root?"rot":void 0,viewProps:r.viewProps})}))).onTitleClick_=i.onTitleClick_.bind(s(i)),i.props=r.props,i.foldable=a,Lt(i.foldable,i.view.containerElement),i.rackController.rack.emitter.on("add",(function(){i.foldable.cleanUpTransition()})),i.rackController.rack.emitter.on("remove",(function(){i.foldable.cleanUpTransition()})),i.view.buttonElement.addEventListener("click",i.onTitleClick_),i}return v(n,[{key:"document",get:function(){return this.view.element.ownerDocument}},{key:"onTitleClick_",value:function(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}]),n}(Wt),ae={id:"folder",type:"blade",accept:function(t){var e=X,n=$(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:function(t){return new oe(t.document,{blade:t.blade,expanded:t.params.expanded,props:H.fromObject({title:t.params.title}),viewProps:t.viewProps})},api:function(t){return t.controller instanceof oe?new Zt(t.controller,t.pool):null}},se=function(t){c(n,t);var e=p(n);function n(t,r){var i;h(this,n);var o=r.valueController.viewProps;return(i=e.call(this,Object.assign(Object.assign({},r),{value:r.valueController.value,view:new Ct(t,{props:r.props,viewProps:o}),viewProps:o}))).props=r.props,i.valueController=r.valueController,i.view.valueElement.appendChild(i.valueController.view.element),i}return v(n)}(Vt),le=function(t){c(n,t);var e=p(n);function n(){return h(this,n),e.apply(this,arguments)}return v(n)}(n),ue=T("spr"),ce=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(ue()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("hr");r.classList.add(ue("r")),this.element.appendChild(r)})),pe=function(t){c(n,t);var e=p(n);function n(t,r){return h(this,n),e.call(this,Object.assign(Object.assign({},r),{view:new ce(t,{viewProps:r.viewProps})}))}return v(n)}(st),de={id:"separator",type:"blade",accept:function(t){var e=$(t,{view:X.required.constant("separator")});return e?{params:e}:null},controller:function(t){return new pe(t.document,{blade:t.blade,viewProps:t.viewProps})},api:function(t){return t.controller instanceof pe?new le(t.controller):null}},he=T("tbi"),ve=v((function t(e,n){var r=this;h(this,t),this.element=e.createElement("div"),this.element.classList.add(he()),n.viewProps.bindClassModifiers(this.element),R(n.props,"selected",(function(t){t?r.element.classList.add(he(void 0,"sel")):r.element.classList.remove(he(void 0,"sel"))}));var i=e.createElement("button");i.classList.add(he("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;var o=e.createElement("div");o.classList.add(he("t")),F(n.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o})),fe=function(){function t(e,n){h(this,t),this.emitter=new S,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new ve(e,{props:n.props,viewProps:n.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}return v(t,[{key:"onClick_",value:function(){this.emitter.emit("click",{sender:this})}}]),t}(),me=function(){function t(e,n){var r=this;h(this,t),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new fe(e,{props:n.itemProps,viewProps:rt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new ne(e,{blade:St(),viewProps:rt.create()}),this.props=n.props,R(this.props,"selected",(function(t){r.itemController.props.set("selected",t),r.contentController.viewProps.set("hidden",!t)}))}return v(t,[{key:"itemController",get:function(){return this.ic_}},{key:"contentController",get:function(){return this.cc_}},{key:"onItemClick_",value:function(){this.props.set("selected",!0)}}]),t}(),be=function(){function t(e,n){h(this,t),this.controller_=e,this.rackApi_=n}return v(t,[{key:"title",get:function(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""},set:function(t){this.controller_.itemController.props.set("title",t)}},{key:"selected",get:function(){return this.controller_.props.get("selected")},set:function(t){this.controller_.props.set("selected",t)}},{key:"children",get:function(){return this.rackApi_.children}},{key:"addButton",value:function(t){return this.rackApi_.addButton(t)}},{key:"addFolder",value:function(t){return this.rackApi_.addFolder(t)}},{key:"addSeparator",value:function(t){return this.rackApi_.addSeparator(t)}},{key:"addTab",value:function(t){return this.rackApi_.addTab(t)}},{key:"add",value:function(t,e){this.rackApi_.add(t,e)}},{key:"remove",value:function(t){this.rackApi_.remove(t)}},{key:"addInput",value:function(t,e,n){return this.rackApi_.addInput(t,e,n)}},{key:"addMonitor",value:function(t,e,n){return this.rackApi_.addMonitor(t,e,n)}},{key:"addBlade",value:function(t){return this.rackApi_.addBlade(t)}}]),t}(),_e=function(t){c(n,t);var e=p(n);function n(t,r){var i;return h(this,n),(i=e.call(this,t,new qt(t.rackController,r))).onPageAdd_=i.onPageAdd_.bind(s(i)),i.onPageRemove_=i.onPageRemove_.bind(s(i)),i.onSelect_=i.onSelect_.bind(s(i)),i.emitter_=new S,i.pageApiMap_=new Map,i.rackApi_.on("change",(function(t){i.emitter_.emit("change",{event:t})})),i.rackApi_.on("update",(function(t){i.emitter_.emit("update",{event:t})})),i.controller_.tab.selectedIndex.emitter.on("change",i.onSelect_),i.controller_.pageSet.emitter.on("add",i.onPageAdd_),i.controller_.pageSet.emitter.on("remove",i.onPageRemove_),i.controller_.pageSet.items.forEach((function(t){i.setUpPageApi_(t)})),i}return v(n,[{key:"pages",get:function(){var t=this;return this.controller_.pageSet.items.map((function(e){var n=t.pageApiMap_.get(e);if(!n)throw P.shouldNeverHappen();return n}))}},{key:"addPage",value:function(t){var e=this.controller_.view.element.ownerDocument,n=new me(e,{itemProps:H.fromObject({selected:!1,title:t.title}),props:H.fromObject({selected:!1})});this.controller_.add(n,t.index);var r=this.pageApiMap_.get(n);if(!r)throw P.shouldNeverHappen();return r}},{key:"removePage",value:function(t){this.controller_.remove(t)}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}},{key:"setUpPageApi_",value:function(t){var e=this.rackApi_.apiSet_.find((function(e){return e.controller_===t.contentController}));if(!e)throw P.shouldNeverHappen();var n=new be(t,e);this.pageApiMap_.set(t,n)}},{key:"onPageAdd_",value:function(t){this.setUpPageApi_(t.item)}},{key:"onPageRemove_",value:function(t){if(!this.pageApiMap_.get(t.item))throw P.shouldNeverHappen();this.pageApiMap_.delete(t.item)}},{key:"onSelect_",value:function(t){this.emitter_.emit("select",{event:new g(this,t.rawValue)})}}]),n}(Mt),ge=-1,we=function(){function t(){h(this,t),this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=G(!0),this.selectedIndex=G(ge),this.items_=[]}return v(t,[{key:"add",value:function(t,e){var n=null!==e&&void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}},{key:"remove",value:function(t){var e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}},{key:"keepSelection_",value:function(){if(0===this.items_.length)return this.selectedIndex.rawValue=ge,void(this.empty.rawValue=!0);var t=this.items_.findIndex((function(t){return t.rawValue}));t<0?(this.items_.forEach((function(t,e){t.rawValue=0===e})),this.selectedIndex.rawValue=0):(this.items_.forEach((function(e,n){e.rawValue=n===t})),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}},{key:"onItemSelectedChange_",value:function(t){if(t.rawValue){var e=this.items_.findIndex((function(e){return e===t.sender}));this.items_.forEach((function(t,n){t.rawValue=n===e})),this.selectedIndex.rawValue=e}else this.keepSelection_()}}]),t}(),ye=T("tab"),xe=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(ye(),re()),n.viewProps.bindClassModifiers(this.element),M(n.empty,U(this.element,ye(void 0,"nop")));var r=e.createElement("div");r.classList.add(ye("t")),this.element.appendChild(r),this.itemsElement=r;var i=e.createElement("div");i.classList.add(ye("i")),this.element.appendChild(i);var o=n.contentsElement;o.classList.add(ye("c")),this.element.appendChild(o),this.contentsElement=o})),ke=function(t){c(n,t);var e=p(n);function n(t,r){var i;h(this,n);var o=new ne(t,{blade:r.blade,viewProps:r.viewProps}),a=new we;return(i=e.call(this,{blade:r.blade,rackController:o,view:new xe(t,{contentsElement:o.view.element,empty:a.empty,viewProps:r.viewProps})})).onPageAdd_=i.onPageAdd_.bind(s(i)),i.onPageRemove_=i.onPageRemove_.bind(s(i)),i.pageSet_=new It((function(){return null})),i.pageSet_.emitter.on("add",i.onPageAdd_),i.pageSet_.emitter.on("remove",i.onPageRemove_),i.tab=a,i}return v(n,[{key:"pageSet",get:function(){return this.pageSet_}},{key:"add",value:function(t,e){this.pageSet_.add(t,e)}},{key:"remove",value:function(t){this.pageSet_.remove(this.pageSet_.items[t])}},{key:"onPageAdd_",value:function(t){var e=t.item;bt(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}},{key:"onPageRemove_",value:function(t){var e=t.item;_t(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}]),n}(Wt),Ce={id:"tab",type:"blade",accept:function(t){var e=X,n=$(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller:function(t){var e=new ke(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((function(n){var r=new me(t.document,{itemProps:H.fromObject({selected:!1,title:n.title}),props:H.fromObject({selected:!1})});e.add(r)})),e},api:function(t){return t.controller instanceof ke?new _e(t.controller,t.pool):null}};function Pe(t,e){var n=t.accept(e.params);if(!n)return null;var r=X.optional.boolean(e.params.disabled).value,i=X.optional.boolean(e.params.hidden).value;return t.controller({blade:St(),document:e.document,params:w(Object.assign(Object.assign({},n.params),{disabled:r,hidden:i})),viewProps:rt.create({disabled:r,hidden:i})})}var Ee=function(){function t(){h(this,t),this.disabled=!1,this.emitter=new S}return v(t,[{key:"dispose",value:function(){}},{key:"tick",value:function(){this.disabled||this.emitter.emit("tick",{sender:this})}}]),t}(),Ve=function(){function t(e,n){h(this,t),this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new S,this.interval_=n,this.setTimer_()}return v(t,[{key:"disabled",get:function(){return this.disabled_},set:function(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}},{key:"dispose",value:function(){this.clearTimer_()}},{key:"clearTimer_",value:function(){if(null!==this.timerId_){var t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}}},{key:"setTimer_",value:function(){if(this.clearTimer_(),!(this.interval_<=0)){var t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}}},{key:"onTick_",value:function(){this.disabled_||this.emitter.emit("tick",{sender:this})}}]),t}(),Se=function(){function t(e){h(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new S,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}return v(t,[{key:"read",value:function(){var t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}},{key:"write_",value:function(t){this.writer(this.target,t)}},{key:"onValueChange_",value:function(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}]),t}();function Ae(t,e){for(;t.length<e;)t.push(void 0)}function Te(t){var e=[];return Ae(e,t),G(e)}function De(t){var e=t.indexOf(void 0);return w(e<0?t:t.slice(0,e))}function Le(t,e){var n=[].concat(l(De(t)),[e]);return n.length>t.length?n.splice(0,n.length-t.length):Ae(n,t.length),n}var Me=function(){function t(e){h(this,t),this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new S,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}return v(t,[{key:"dispose",value:function(){this.ticker.dispose()}},{key:"read",value:function(){var t=this.target.read();if(void 0!==t){var e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=Le(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}}},{key:"onTick_",value:function(t){this.read()}}]),t}(),Re=function(){function t(e){h(this,t),this.constraints=e}return v(t,[{key:"constrain",value:function(t){return this.constraints.reduce((function(t,e){return e.constrain(t)}),t)}}]),t}();function Be(t,e){if(t instanceof e)return t;if(t instanceof Re){var n=t.constraints.reduce((function(t,n){return t||(n instanceof e?n:null)}),null);if(n)return n}return null}var Ue=function(){function t(e){h(this,t),this.values=H.fromObject({max:e.max,min:e.min})}return v(t,[{key:"constrain",value:function(t){var e=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(t,n),e)}}]),t}(),Fe=function(){function t(e){h(this,t),this.values=H.fromObject({options:e})}return v(t,[{key:"options",get:function(){return this.values.get("options")}},{key:"constrain",value:function(t){var e=this.values.get("options");return 0===e.length||e.filter((function(e){return e.value===t})).length>0?t:e[0].value}}]),t}(),Ie=function(){function t(e){h(this,t),this.values=H.fromObject({max:e.max,min:e.min})}return v(t,[{key:"maxValue",get:function(){return this.values.get("max")}},{key:"minValue",get:function(){return this.values.get("min")}},{key:"constrain",value:function(t){var e=this.values.get("max"),n=this.values.get("min"),r=t;return y(n)||(r=Math.max(r,n)),y(e)||(r=Math.min(r,e)),r}}]),t}(),Oe=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;h(this,t),this.step=e,this.origin=n}return v(t,[{key:"constrain",value:function(t){var e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}]),t}(),je=T("lst"),Ne=function(){function t(e,n){var r=this;h(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.element=e.createElement("div"),this.element.classList.add(je()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("select");i.classList.add(je("s")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;var o=e.createElement("div");o.classList.add(je("m")),o.appendChild(mt(e,"dropdown")),this.element.appendChild(o),n.value.emitter.on("change",this.onValueChange_),this.value_=n.value,R(this.props_,"options",(function(t){gt(r.selectElement),t.forEach((function(t){var n=e.createElement("option");n.textContent=t.text,r.selectElement.appendChild(n)})),r.update_()}))}return v(t,[{key:"update_",value:function(){var t=this.props_.get("options").map((function(t){return t.value}));this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Ke=function(){function t(e,n){h(this,t),this.onSelectChange_=this.onSelectChange_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Ne(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}return v(t,[{key:"onSelectChange_",value:function(t){var e=w(t.currentTarget);this.value.rawValue=this.props.get("options")[e.selectedIndex].value}}]),t}(),Ge=T("pop"),He=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(Ge()),n.viewProps.bindClassModifiers(this.element),M(n.shows,U(this.element,Ge(void 0,"v")))})),ze=v((function t(e,n){h(this,t),this.shows=G(!1),this.viewProps=n.viewProps,this.view=new He(e,{shows:this.shows,viewProps:this.viewProps})})),qe=T("txt"),Ze=function(){function t(e,n){h(this,t),this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(qe()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);var r=e.createElement("input");r.classList.add(qe("i")),r.type="text",n.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}return v(t,[{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),We=function(){function t(e,n){h(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new Ze(e,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return v(t,[{key:"onInputChange_",value:function(t){var e=w(t.currentTarget).value,n=this.parser_(e);y(n)||(this.value.rawValue=n),this.view.refresh()}}]),t}();function Ye(t){return String(t)}function Xe(t){return"false"!==t&&!!t}function $e(t){return Ye(t)}var Qe=function(){function t(e){h(this,t),this.text=e}return v(t,[{key:"evaluate",value:function(){return Number(this.text)}},{key:"toString",value:function(){return this.text}}]),t}(),Je={"**":function(t,e){return Math.pow(t,e)},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"<<":function(t,e){return t<<e},">>":function(t,e){return t>>e},">>>":function(t,e){return t>>>e},"&":function(t,e){return t&e},"^":function(t,e){return t^e},"|":function(t,e){return t|e}},tn=function(){function t(e,n,r){h(this,t),this.left=n,this.operator=e,this.right=r}return v(t,[{key:"evaluate",value:function(){var t=Je[this.operator];if(!t)throw new Error("unexpected binary operator: '".concat(this.operator));return t(this.left.evaluate(),this.right.evaluate())}},{key:"toString",value:function(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}]),t}(),en={"+":function(t){return t},"-":function(t){return-t},"~":function(t){return~t}},nn=function(){function t(e,n){h(this,t),this.operator=e,this.expression=n}return v(t,[{key:"evaluate",value:function(){var t=en[this.operator];if(!t)throw new Error("unexpected unary operator: '".concat(this.operator));return t(this.expression.evaluate())}},{key:"toString",value:function(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}]),t}();function rn(t){return function(e,n){for(var r=0;r<t.length;r++){var i=t[r](e,n);if(""!==i)return i}return""}}function on(t,e){var n,r=t.substr(e).match(/^\s+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function an(t,e){var n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function sn(t,e){var n,r=t.substr(e).match(/^[0-9]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function ln(t,e){var n=sn(t,e);if(""!==n)return n;var r=t.substr(e,1);if("-"!==r&&"+"!==r)return"";var i=sn(t,e+=1);return""===i?"":r+i}function un(t,e){var n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";var r=ln(t,e);return""===r?"":n+r}function cn(t,e){var n=t.substr(e,1);if("0"===n)return n;var r=an(t,e);return e+=r.length,""===r?"":r+sn(t,e)}function pn(t,e){var n=cn(t,e);if(e+=n.length,""===n)return"";var r=t.substr(e,1);if(e+=r.length,"."!==r)return"";var i=sn(t,e);return n+r+i+un(t,e+=i.length)}function dn(t,e){var n=t.substr(e,1);if(e+=n.length,"."!==n)return"";var r=sn(t,e);return e+=r.length,""===r?"":n+r+un(t,e)}function hn(t,e){var n=cn(t,e);return e+=n.length,""===n?"":n+un(t,e)}var vn=rn([pn,dn,hn]);function fn(t,e){var n,r=t.substr(e).match(/^[01]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function mn(t,e){var n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";var r=fn(t,e);return""===r?"":n+r}function bn(t,e){var n,r=t.substr(e).match(/^[0-7]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function _n(t,e){var n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";var r=bn(t,e);return""===r?"":n+r}function gn(t,e){var n,r=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=r&&r[0])&&void 0!==n?n:""}function wn(t,e){var n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";var r=gn(t,e);return""===r?"":n+r}var yn=rn([mn,_n,wn]),xn=rn([yn,vn]);function kn(t,e){var n=xn(t,e);return e+=n.length,""===n?null:{evaluable:new Qe(n),cursor:e}}function Cn(t,e){var n=t.substr(e,1);if(e+=n.length,"("!==n)return null;var r=Tn(t,e);if(!r)return null;e=r.cursor,e+=on(t,e).length;var i=t.substr(e,1);return e+=i.length,")"!==i?null:{evaluable:r.evaluable,cursor:e}}function Pn(t,e){var n;return null!==(n=kn(t,e))&&void 0!==n?n:Cn(t,e)}function En(t,e){var n=Pn(t,e);if(n)return n;var r=t.substr(e,1);if(e+=r.length,"+"!==r&&"-"!==r&&"~"!==r)return null;var i=En(t,e);return i?{cursor:e=i.cursor,evaluable:new nn(r,i.evaluable)}:null}function Vn(t,e,n){n+=on(e,n).length;var r=t.filter((function(t){return e.startsWith(t,n)}))[0];return r?(n+=r.length,{cursor:n+=on(e,n).length,operator:r}):null}function Sn(t,e){return function(n,r){var i=t(n,r);if(!i)return null;r=i.cursor;for(var o=i.evaluable;;){var a=Vn(e,n,r);if(!a)break;r=a.cursor;var s=t(n,r);if(!s)return null;r=s.cursor,o=new tn(a.operator,o,s.evaluable)}return o?{cursor:r,evaluable:o}:null}}var An=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((function(t,e){return Sn(t,e)}),En);function Tn(t,e){return e+=on(t,e).length,An(t,e)}function Dn(t){var e=Tn(t,0);return e?e.cursor+on(t,e.cursor).length!==t.length?null:e.evaluable:null}function Ln(t){var e,n=Dn(t);return null!==(e=null===n||void 0===n?void 0:n.evaluate())&&void 0!==e?e:null}function Mn(t){if("number"===typeof t)return t;if("string"===typeof t){var e=Ln(t);if(!y(e))return e}return 0}function Rn(t){return String(t)}function Bn(t){return function(e){return e.toFixed(Math.max(Math.min(t,20),0))}}var Un=Bn(0);function Fn(t){return Un(t)+"%"}function In(t){return String(t)}function On(t){return t}function jn(t){var e=t.primary,n=t.secondary,r=t.forward,i=t.backward,o=!1;function a(t){o||(o=!0,t(),o=!1)}e.emitter.on("change",(function(t){a((function(){n.setRawValue(r(e,n),t.options)}))})),n.emitter.on("change",(function(t){a((function(){e.setRawValue(i(e,n),t.options)})),a((function(){n.setRawValue(r(e,n),t.options)}))})),a((function(){n.setRawValue(r(e,n),{forceEmit:!1,last:!0})}))}function Nn(t,e){var n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Kn(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Gn(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Hn(t){return"ArrowUp"===t||"ArrowDown"===t}function zn(t){return Hn(t)||"ArrowLeft"===t||"ArrowRight"===t}function qn(t,e){var n,r,i=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(n=i&&i.scrollX)&&void 0!==n?n:0)+o.left),y:t.pageY-((null!==(r=i&&i.scrollY)&&void 0!==r?r:0)+o.top)}}var Zn=function(){function t(e){h(this,t),this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new S,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}return v(t,[{key:"computePosition_",value:function(t){var e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}},{key:"onMouseDown_",value:function(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();var n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(qn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseMove_",value:function(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(qn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onDocumentMouseUp_",value:function(t){var e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(qn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}},{key:"onTouchStart_",value:function(t){t.preventDefault();var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchMove_",value:function(t){var e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}},{key:"onTouchEnd_",value:function(t){var e,n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-r.left,y:n.clientY-r.top}:void 0),sender:this,shiftKey:t.shiftKey})}}]),t}();function Wn(t,e,n,r,i){return r+(t-e)/(n-e)*(i-r)}function Yn(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Xn(t,e,n){return Math.min(Math.max(t,e),n)}function $n(t,e){return(t%e+e)%e}var Qn=T("txt"),Jn=function(){function t(e,n){h(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Qn(),Qn(void 0,"num")),n.arrayPosition&&this.element.classList.add(Qn(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("input");r.classList.add(Qn("i")),r.type="text",n.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Qn()),this.inputElement.classList.add(Qn("i"));var i=e.createElement("div");i.classList.add(Qn("k")),this.element.appendChild(i),this.knobElement=i;var o=e.createElementNS(lt,"svg");o.classList.add(Qn("g")),this.knobElement.appendChild(o);var a=e.createElementNS(lt,"path");a.classList.add(Qn("gb")),o.appendChild(a),this.guideBodyElem_=a;var s=e.createElementNS(lt,"path");s.classList.add(Qn("gh")),o.appendChild(s),this.guideHeadElem_=s;var l=e.createElement("div");l.classList.add(T("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}return v(t,[{key:"onDraggingChange_",value:function(t){if(null!==t.rawValue){this.element.classList.add(Qn(void 0,"drg"));var e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),r=Xn(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(n+r,",0 L").concat(n,",4 L").concat(n+r,",8"),"M ".concat(e,",-1 L").concat(e,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(e,",4"));var i=this.props_.get("formatter");this.tooltipElem_.textContent=i(this.value.rawValue),this.tooltipElem_.style.left="".concat(e,"px")}else this.element.classList.remove(Qn(void 0,"drg"))}},{key:"refresh",value:function(){var t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}},{key:"onChange_",value:function(){this.refresh()}}]),t}(),tr=function(){function t(e,n){var r;h(this,t),this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.parser_=n.parser,this.props=n.props,this.sliderProps_=null!==(r=n.sliderProps)&&void 0!==r?r:null,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=G(null),this.view=new Jn(e,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);var i=new Zn(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}return v(t,[{key:"constrainValue_",value:function(t){var e,n,r=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),i=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("maxValue"),o=t;return void 0!==r&&(o=Math.max(o,r)),void 0!==i&&(o=Math.min(o,i)),o}},{key:"onInputChange_",value:function(t){var e=w(t.currentTarget).value,n=this.parser_(e);y(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}},{key:"onInputKeyDown_",value:function(t){var e=Nn(this.baseStep_,Kn(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}},{key:"onInputKeyUp_",value:function(t){0!==Nn(this.baseStep_,Kn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},{key:"onPointerDown_",value:function(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}},{key:"computeDraggingValue_",value:function(t){if(!t.point)return null;var e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}},{key:"onPointerMove_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}},{key:"onPointerUp_",value:function(t){var e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}]),t}(),er=T("sld"),nr=function(){function t(e,n){h(this,t),this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(er()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(er("t")),n.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;var i=e.createElement("div");i.classList.add(er("k")),this.trackElement.appendChild(i),this.knobElement=i,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.update_()}return v(t,[{key:"update_",value:function(){var t=Xn(Wn(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width="".concat(t,"%")}},{key:"onChange_",value:function(){this.update_()}}]),t}(),rr=function(){function t(e,n){h(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=n.baseStep,this.value=n.value,this.viewProps=n.viewProps,this.props=n.props,this.view=new nr(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zn(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}return v(t,[{key:"handlePointerEvent_",value:function(t,e){t.point&&this.value.setRawValue(Wn(Xn(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}},{key:"onPointerDownOrMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=Nn(this.baseStep_,Gn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){0!==Nn(this.baseStep_,Gn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),ir=T("sldtxt"),or=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(ir());var r=e.createElement("div");r.classList.add(ir("s")),this.sliderView_=n.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(ir("t")),this.textView_=n.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)})),ar=function(){function t(e,n){h(this,t),this.value=n.value,this.viewProps=n.viewProps,this.sliderC_=new rr(e,{baseStep:n.baseStep,props:n.sliderProps,value:n.value,viewProps:this.viewProps}),this.textC_=new tr(e,{baseStep:n.baseStep,parser:n.parser,props:n.textProps,sliderProps:n.sliderProps,value:n.value,viewProps:n.viewProps}),this.view=new or(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}return v(t,[{key:"sliderController",get:function(){return this.sliderC_}},{key:"textController",get:function(){return this.textC_}}]),t}();function sr(t,e){t.write(e)}function lr(t){var e=X;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"===typeof t?e.required.raw(t).value:void 0}function ur(t){if("inline"===t||"popup"===t)return t}function cr(t){var e=X;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function pr(t){if(Array.isArray(t))return t;var e=[];return Object.keys(t).forEach((function(n){e.push({text:n,value:t[n]})})),e}function dr(t){return y(t)?null:new Fe(pr(w(t)))}function hr(t){var e=t?Be(t,Oe):null;return e?e.step:null}function vr(t,e){var n=t&&Be(t,Oe);return n?Yn(n.step):Math.max(Yn(e),2)}function fr(t){var e=hr(t);return null!==e&&void 0!==e?e:1}function mr(t,e){var n,r=t&&Be(t,Oe),i=Math.abs(null!==(n=null===r||void 0===r?void 0:r.step)&&void 0!==n?n:e);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}var br=T("ckb"),_r=function(){function t(e,n){h(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(br()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("label");r.classList.add(br("l")),this.element.appendChild(r);var i=e.createElement("input");i.classList.add(br("i")),i.type="checkbox",r.appendChild(i),this.inputElement=i,n.viewProps.bindDisabled(this.inputElement);var o=e.createElement("div");o.classList.add(br("w")),r.appendChild(o);var a=mt(e,"check");o.appendChild(a),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return v(t,[{key:"update_",value:function(){this.inputElement.checked=this.value.rawValue}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),gr=function(){function t(e,n){h(this,t),this.onInputChange_=this.onInputChange_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new _r(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}return v(t,[{key:"onInputChange_",value:function(t){var e=w(t.currentTarget);this.value.rawValue=e.checked}}]),t}();function wr(t){var e=[],n=dr(t.options);return n&&e.push(n),new Re(e)}var yr={id:"input-bool",type:"input",accept:function(t,e){if("boolean"!==typeof t)return null;var n=$(e,{options:X.optional.custom(lr)});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Xe},constraint:function(t){return wr(t.params)},writer:function(t){return sr}},controller:function(t){var e=t.document,n=t.value,r=t.constraint,i=r&&Be(r,Fe);return i?new Ke(e,{props:new H({options:i.values.value("options")}),value:n,viewProps:t.viewProps}):new gr(e,{value:n,viewProps:t.viewProps})}},xr=T("col"),kr=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(xr()),n.foldable.bindExpandedClass(this.element,xr(void 0,"expanded")),R(n.foldable,"completed",U(this.element,xr(void 0,"cpl")));var r=e.createElement("div");r.classList.add(xr("h")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(xr("s")),r.appendChild(i),this.swatchElement=i;var o=e.createElement("div");if(o.classList.add(xr("t")),r.appendChild(o),this.textElement=o,"inline"===n.pickerLayout){var a=e.createElement("div");a.classList.add(xr("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}));function Cr(t,e,n){var r=Xn(t/255,0,1),i=Xn(e/255,0,1),o=Xn(n/255,0,1),a=Math.max(r,i,o),s=Math.min(r,i,o),l=a-s,u=0,c=0,p=(s+a)/2;return 0!==l&&(c=l/(1-Math.abs(a+s-1)),u=(u=r===a?(i-o)/l:i===a?2+(o-r)/l:4+(r-i)/l)/6+(u<0?1:0)),[360*u,100*c,100*p]}function Pr(t,e,n){var r,i,o,a=(t%360+360)%360,s=Xn(e/100,0,1),l=Xn(n/100,0,1),u=(1-Math.abs(2*l-1))*s,c=u*(1-Math.abs(a/60%2-1)),p=l-u/2;return a>=0&&a<60?(r=u,i=c,o=0):a>=60&&a<120?(r=c,i=u,o=0):a>=120&&a<180?(r=0,i=u,o=c):a>=180&&a<240?(r=0,i=c,o=u):a>=240&&a<300?(r=c,i=0,o=u):(r=u,i=0,o=c),[255*(r+p),255*(i+p),255*(o+p)]}function Er(t,e,n){var r=Xn(t/255,0,1),i=Xn(e/255,0,1),o=Xn(n/255,0,1),a=Math.max(r,i,o),s=a-Math.min(r,i,o);return[0===s?0:a===r?((i-o)/s%6+6)%6*60:a===i?60*((o-r)/s+2):60*((r-i)/s+4),100*(0===a?0:s/a),100*a]}function Vr(t,e,n){var r,i,o,a=$n(t,360),s=Xn(e/100,0,1),l=Xn(n/100,0,1),u=l*s,c=u*(1-Math.abs(a/60%2-1)),p=l-u;return a>=0&&a<60?(r=u,i=c,o=0):a>=60&&a<120?(r=c,i=u,o=0):a>=120&&a<180?(r=0,i=u,o=c):a>=180&&a<240?(r=0,i=c,o=u):a>=240&&a<300?(r=c,i=0,o=u):(r=u,i=0,o=c),[255*(r+p),255*(i+p),255*(o+p)]}function Sr(t,e,n){var r=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==r?e*(100-Math.abs(2*n-100))/r:0,n+e*(100-Math.abs(2*n-100))/200]}function Ar(t,e,n){var r=100-Math.abs(n*(200-e)/100-100);return[t,0!==r?e*n/r:0,n*(200-e)/200]}function Tr(t){return[t[0],t[1],t[2]]}function Dr(t,e){return[t[0],t[1],t[2],e]}var Lr={hsl:{hsl:function(t,e,n){return[t,e,n]},hsv:Sr,rgb:Pr},hsv:{hsl:Ar,hsv:function(t,e,n){return[t,e,n]},rgb:Vr},rgb:{hsl:Cr,hsv:Er,rgb:function(t,e,n){return[t,e,n]}}};function Mr(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function Rr(t,e){return t===e?e:$n(t,e)}function Br(t,e,n){var r,i=Mr(e,n);return["rgb"===e?Xn(t[0],0,i[0]):Rr(t[0],i[0]),Xn(t[1],0,i[1]),Xn(t[2],0,i[2]),Xn(null!==(r=t[3])&&void 0!==r?r:1,0,1)]}function Ur(t,e,n,r){var i=Mr(e,n),o=Mr(e,r);return t.map((function(t,e){return t/i[e]*o[e]}))}function Fr(t,e,n){var r,i=Ur(t,e.mode,e.type,"int");return Ur((r=Lr[e.mode])[n.mode].apply(r,l(i)),n.mode,"int",n.type)}function Ir(t,e){return"object"===typeof t&&!y(t)&&e in t&&"number"===typeof t[e]}var Or=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"int";h(this,t),this.mode=n,this.type=r,this.comps_=Br(e,n,r)}return v(t,[{key:"getComponents",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"int";return Dr(Fr(Tr(this.comps_),{mode:this.mode,type:this.type},{mode:null!==t&&void 0!==t?t:this.mode,type:e}),this.comps_[3])}},{key:"toRgbaObject",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"int",e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}],[{key:"black",value:function(){return new t([0,0,0],"rgb",arguments.length>0&&void 0!==arguments[0]?arguments[0]:"int")}},{key:"fromObject",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"int";return new t("a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b],"rgb",n)}},{key:"toRgbaObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"int";return t.toRgbaObject(e)}},{key:"isRgbColorObject",value:function(t){return Ir(t,"r")&&Ir(t,"g")&&Ir(t,"b")}},{key:"isRgbaColorObject",value:function(t){return this.isRgbColorObject(t)&&Ir(t,"a")}},{key:"isColorObject",value:function(t){return this.isRgbColorObject(t)}},{key:"equals",value:function(t,e){if(t.mode!==e.mode)return!1;for(var n=t.comps_,r=e.comps_,i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}}]),t}(),jr=T("colp"),Nr=function(){function t(e,n){h(this,t),this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(jr()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(jr("hsv"));var i=e.createElement("div");i.classList.add(jr("sv")),this.svPaletteView_=n.svPaletteView,i.appendChild(this.svPaletteView_.element),r.appendChild(i);var o=e.createElement("div");o.classList.add(jr("h")),this.hPaletteView_=n.hPaletteView,o.appendChild(this.hPaletteView_.element),r.appendChild(o),this.element.appendChild(r);var a=e.createElement("div");if(a.classList.add(jr("rgb")),this.textView_=n.textView,a.appendChild(this.textView_.element),this.element.appendChild(a),n.alphaViews){this.alphaViews_={palette:n.alphaViews.palette,text:n.alphaViews.text};var s=e.createElement("div");s.classList.add(jr("a"));var l=e.createElement("div");l.classList.add(jr("ap")),l.appendChild(this.alphaViews_.palette.element),s.appendChild(l);var u=e.createElement("div");u.classList.add(jr("at")),u.appendChild(this.alphaViews_.text.element),s.appendChild(u),this.element.appendChild(s)}}return v(t,[{key:"allFocusableElements",get:function(){var t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement].concat(l(this.textView_.textViews.map((function(t){return t.inputElement}))));return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}]),t}();function Kr(t){return"int"===t?"int":"float"===t?"float":void 0}function Gr(t){var e=X;return $(t,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Kr)}),expanded:e.optional.boolean,picker:e.optional.custom(ur)})}function Hr(t){return t?.1:1}function zr(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}function qr(t,e){return t.alpha===e.alpha&&t.mode===e.mode&&t.notation===e.notation&&t.type===e.type}function Zr(t,e){var n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}var Wr={deg:function(t){return t},grad:function(t){return 360*t/400},rad:function(t){return 360*t/(2*Math.PI)},turn:function(t){return 360*t}};function Yr(t){var e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);var n=parseFloat(e[1]),r=e[2];return Wr[r](n)}function Xr(t){var e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Zr(e[1],255),Zr(e[2],255),Zr(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function $r(t){return function(e){var n=Xr(e);return n?new Or(n,"rgb",t):null}}function Qr(t){var e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Zr(e[1],255),Zr(e[2],255),Zr(e[3],255),Zr(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Jr(t){return function(e){var n=Qr(e);return n?new Or(n,"rgb",t):null}}function ti(t){var e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Yr(e[1]),Zr(e[2],100),Zr(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function ei(t){return function(e){var n=ti(e);return n?new Or(n,"hsl",t):null}}function ni(t){var e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;var n=[Yr(e[1]),Zr(e[2],100),Zr(e[3],100),Zr(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function ri(t){return function(e){var n=ni(e);return n?new Or(n,"hsl",t):null}}function ii(t){var e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];var n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function oi(t){var e=ii(t);return e?new Or(e,"rgb","int"):null}function ai(t){var e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Wn(parseInt(e[4]+e[4],16),0,255,0,1)];var n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Wn(parseInt(n[4],16),0,255,0,1)]:null}function si(t){var e=ai(t);return e?new Or(e,"rgb","int"):null}function li(t){var e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;var n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function ui(t){return function(e){var n=li(e);return n?new Or(n,"rgb",t):null}}function ci(t){var e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;var n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function pi(t){return function(e){var n=ci(e);return n?new Or(n,"rgb",t):null}}var di=[{parser:ii,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:ai,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Xr,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Qr,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:ti,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:ni,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:li,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:ci,result:{alpha:!0,mode:"rgb",notation:"object"}}];function hi(t){return di.reduce((function(e,n){var r=n.parser,i=n.result;return e||(r(t)?i:null)}),null)}function vi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"int",n=hi(t);return n?"hex"===n.notation&&"float"!==e?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:e}):null:null}var fi={int:[oi,si,$r("int"),Jr("int"),ei("int"),ri("int"),ui("int"),pi("int")],float:[$r("float"),Jr("float"),ei("float"),ri("float"),ui("float"),pi("float")]};function mi(t){var e=fi[t];return function(n){if("string"!==typeof n)return Or.black(t);var r=e.reduce((function(t,e){return t||e(n)}),null);return null!==r&&void 0!==r?r:Or.black(t)}}function bi(t){var e=fi[t];return function(t){return e.reduce((function(e,n){return e||n(t)}),null)}}function _i(t){var e=Xn(Math.floor(t),0,255).toString(16);return 1===e.length?"0".concat(e):e}function gi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=Tr(t.getComponents("rgb")).map(_i).join("");return"".concat(e).concat(n)}function wi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=t.getComponents("rgb"),r=[n[0],n[1],n[2],255*n[3]].map(_i).join("");return"".concat(e).concat(r)}function yi(t,e){var n=Bn("float"===e?2:0),r=Tr(t.getComponents("rgb",e)).map((function(t){return n(t)}));return"rgb(".concat(r.join(", "),")")}function xi(t){return function(e){return yi(e,t)}}function ki(t,e){var n=Bn(2),r=Bn("float"===e?2:0),i=t.getComponents("rgb",e).map((function(t,e){return(3===e?n:r)(t)}));return"rgba(".concat(i.join(", "),")")}function Ci(t){return function(e){return ki(e,t)}}function Pi(t){var e=[Bn(0),Fn,Fn],n=Tr(t.getComponents("hsl")).map((function(t,n){return e[n](t)}));return"hsl(".concat(n.join(", "),")")}function Ei(t){var e=[Bn(0),Fn,Fn,Bn(2)],n=t.getComponents("hsl").map((function(t,n){return e[n](t)}));return"hsla(".concat(n.join(", "),")")}function Vi(t,e){var n=Bn("float"===e?2:0),r=["r","g","b"],i=Tr(t.getComponents("rgb",e)).map((function(t,e){return"".concat(r[e],": ").concat(n(t))}));return"{".concat(i.join(", "),"}")}function Si(t){return function(e){return Vi(e,t)}}function Ai(t,e){var n=Bn(2),r=Bn("float"===e?2:0),i=["r","g","b","a"],o=t.getComponents("rgb",e).map((function(t,e){var o=3===e?n:r;return"".concat(i[e],": ").concat(o(t))}));return"{".concat(o.join(", "),"}")}function Ti(t){return function(e){return Ai(e,t)}}var Di=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:gi},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:wi},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Pi},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Ei}].concat(l(["int","float"].reduce((function(t,e){return[].concat(l(t),[{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:xi(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:Ci(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Si(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Ti(e)}])}),[])));function Li(t){return Di.reduce((function(e,n){return e||(qr(n.format,t)?n.stringifier:null)}),null)}var Mi=T("apl"),Ri=function(){function t(e,n){h(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Mi()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(Mi("b")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(Mi("c")),r.appendChild(i),this.colorElem_=i;var o=e.createElement("div");o.classList.add(Mi("m")),this.element.appendChild(o),this.markerElem_=o;var a=e.createElement("div");a.classList.add(Mi("p")),this.markerElem_.appendChild(a),this.previewElem_=a,this.update_()}return v(t,[{key:"update_",value:function(){var t=this.value.rawValue,e=t.getComponents("rgb"),n=new Or([e[0],e[1],e[2],0],"rgb"),r=new Or([e[0],e[1],e[2],255],"rgb"),i=["to right",ki(n),ki(r)];this.colorElem_.style.background="linear-gradient(".concat(i.join(","),")"),this.previewElem_.style.backgroundColor=ki(t);var o=Wn(e[3],0,1,0,100);this.markerElem_.style.left="".concat(o,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Bi=function(){function t(e,n){h(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Ri(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return v(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=t.point.x/t.bounds.width,r=this.value.rawValue.getComponents("hsv"),i=d(r,3),o=i[0],a=i[1],s=i[2];this.value.setRawValue(new Or([o,a,s,n],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=Nn(Hr(!0),Gn(t));if(0!==e){var n=this.value.rawValue.getComponents("hsv"),r=d(n,4),i=r[0],o=r[1],a=r[2],s=r[3];this.value.setRawValue(new Or([i,o,a,s+e],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(t){0!==Nn(Hr(!0),Gn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),Ui=T("coltxt");function Fi(t){var e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce((function(e,n){var r=t.createElement("option");return r.textContent=n.text,r.value=n.value,e.appendChild(r),e}),t.createDocumentFragment())),e}var Ii=function(){function t(e,n){var r=this;h(this,t),this.element=e.createElement("div"),this.element.classList.add(Ui()),n.viewProps.bindClassModifiers(this.element);var i=e.createElement("div");i.classList.add(Ui("m")),this.modeElem_=Fi(e),this.modeElem_.classList.add(Ui("ms")),i.appendChild(this.modeSelectElement),n.viewProps.bindDisabled(this.modeElem_);var o=e.createElement("div");o.classList.add(Ui("mm")),o.appendChild(mt(e,"dropdown")),i.appendChild(o),this.element.appendChild(i);var a=e.createElement("div");a.classList.add(Ui("w")),this.element.appendChild(a),this.textsElem_=a,this.textViews_=n.textViews,this.applyTextViews_(),M(n.colorMode,(function(t){r.modeElem_.value=t}))}return v(t,[{key:"modeSelectElement",get:function(){return this.modeElem_}},{key:"textViews",get:function(){return this.textViews_},set:function(t){this.textViews_=t,this.applyTextViews_()}},{key:"applyTextViews_",value:function(){var t=this;gt(this.textsElem_);var e=this.element.ownerDocument;this.textViews_.forEach((function(n){var r=e.createElement("div");r.classList.add(Ui("c")),r.appendChild(n.element),t.textsElem_.appendChild(r)}))}}]),t}();function Oi(t){return Bn("float"===t?2:0)}function ji(t,e,n){var r=Mr(t,e)[n];return new Ue({min:0,max:r})}function Ni(t,e,n){return new tr(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:Hr(!1),parser:e.parser,props:H.fromObject({draggingScale:"float"===e.colorType?.01:1,formatter:Oi(e.colorType)}),value:G(0,{constraint:ji(e.colorMode,e.colorType,n)}),viewProps:e.viewProps})}var Ki=function(){function t(e,n){h(this,t),this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=n.colorType,this.parser_=n.parser,this.value=n.value,this.viewProps=n.viewProps,this.colorMode=G(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Ii(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}return v(t,[{key:"createComponentControllers_",value:function(t){var e=this,n={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},r=[Ni(t,n,0),Ni(t,n,1),Ni(t,n,2)];return r.forEach((function(t,n){jn({primary:e.value,secondary:t.value,forward:function(t){return t.rawValue.getComponents(e.colorMode.rawValue,e.colorType_)[n]},backward:function(t,r){var i=e.colorMode.rawValue,o=t.rawValue.getComponents(i,e.colorType_);return o[n]=r.rawValue,new Or(Dr(Tr(o),o[3]),i,e.colorType_)}})})),r}},{key:"onModeSelectChange_",value:function(t){var e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}]),t}(),Gi=T("hpl"),Hi=function(){function t(e,n){h(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Gi()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=e.createElement("div");r.classList.add(Gi("c")),this.element.appendChild(r);var i=e.createElement("div");i.classList.add(Gi("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}return v(t,[{key:"update_",value:function(){var t=this.value.rawValue.getComponents("hsv"),e=d(t,1)[0];this.markerElem_.style.backgroundColor=yi(new Or([e,100,100],"hsv"));var n=Wn(e,0,360,0,100);this.markerElem_.style.left="".concat(n,"%")}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),zi=function(){function t(e,n){h(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Hi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return v(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=Wn(Xn(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),r=this.value.rawValue.getComponents("hsv"),i=d(r,4),o=i[1],a=i[2],s=i[3];this.value.setRawValue(new Or([n,o,a,s],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){var e=Nn(Hr(!1),Gn(t));if(0!==e){var n=this.value.rawValue.getComponents("hsv"),r=d(n,4),i=r[0],o=r[1],a=r[2],s=r[3];this.value.setRawValue(new Or([i+e,o,a,s],"hsv"),{forceEmit:!1,last:!1})}}},{key:"onKeyUp_",value:function(t){0!==Nn(Hr(!1),Gn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),qi=T("svp"),Zi=64,Wi=function(){function t(e,n){h(this,t),this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(qi()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);var r=e.createElement("canvas");r.height=Zi,r.width=Zi,r.classList.add(qi("c")),this.element.appendChild(r),this.canvasElement=r;var i=e.createElement("div");i.classList.add(qi("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}return v(t,[{key:"update_",value:function(){var t=vt(this.canvasElement);if(t){for(var e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,r=this.canvasElement.height,i=t.getImageData(0,0,n,r),o=i.data,a=0;a<r;a++)for(var s=0;s<n;s++){var l=Wn(s,0,n,0,100),u=Wn(a,0,r,100,0),c=Vr(e[0],l,u),p=4*(a*n+s);o[p]=c[0],o[p+1]=c[1],o[p+2]=c[2],o[p+3]=255}t.putImageData(i,0,0);var d=Wn(e[1],0,100,0,100);this.markerElem_.style.left="".concat(d,"%");var h=Wn(e[2],0,100,100,0);this.markerElem_.style.top="".concat(h,"%")}}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Yi=function(){function t(e,n){h(this,t),this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Wi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}return v(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=Wn(t.point.x,0,t.bounds.width,0,100),r=Wn(t.point.y,0,t.bounds.height,100,0),i=this.value.rawValue.getComponents("hsv"),o=d(i,4),a=o[0],s=o[3];this.value.setRawValue(new Or([a,n,r,s],"hsv"),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onKeyDown_",value:function(t){zn(t.key)&&t.preventDefault();var e=this.value.rawValue.getComponents("hsv"),n=d(e,4),r=n[0],i=n[1],o=n[2],a=n[3],s=Hr(!1),l=Nn(s,Gn(t)),u=Nn(s,Kn(t));0===l&&0===u||this.value.setRawValue(new Or([r,i+l,o+u,a],"hsv"),{forceEmit:!1,last:!1})}},{key:"onKeyUp_",value:function(t){var e=Hr(!1),n=Nn(e,Gn(t)),r=Nn(e,Kn(t));0===n&&0===r||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),Xi=function(){function t(e,n){h(this,t),this.value=n.value,this.viewProps=n.viewProps,this.hPaletteC_=new zi(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Yi(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=n.supportsAlpha?{palette:new Bi(e,{value:this.value,viewProps:this.viewProps}),text:new tr(e,{parser:Ln,baseStep:.1,props:H.fromObject({draggingScale:.01,formatter:Bn(2)}),value:G(0,{constraint:new Ue({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&jn({primary:this.value,secondary:this.alphaIcs_.text.value,forward:function(t){return t.rawValue.getComponents()[3]},backward:function(t,e){var n=t.rawValue.getComponents();return n[3]=e.rawValue,new Or(n,t.rawValue.mode)}}),this.textC_=new Ki(e,{colorType:n.colorType,parser:Ln,value:this.value,viewProps:this.viewProps}),this.view=new Nr(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:n.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}return v(t,[{key:"textController",get:function(){return this.textC_}}]),t}(),$i=T("colsw"),Qi=function(){function t(e,n){h(this,t),this.onValueChange_=this.onValueChange_.bind(this),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.element=e.createElement("div"),this.element.classList.add($i()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add($i("sw")),this.element.appendChild(r),this.swatchElem_=r;var i=e.createElement("button");i.classList.add($i("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}return v(t,[{key:"update_",value:function(){var t=this.value.rawValue;this.swatchElem_.style.backgroundColor=wi(t)}},{key:"onValueChange_",value:function(){this.update_()}}]),t}(),Ji=v((function t(e,n){h(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new Qi(e,{value:this.value,viewProps:this.viewProps})})),to=function(){function t(e,n){var r=this;h(this,t),this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=At.create(n.expanded),this.swatchC_=new Ji(e,{value:this.value,viewProps:this.viewProps});var i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new We(e,{parser:n.parser,props:H.fromObject({formatter:n.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new kr(e,{foldable:this.foldable_,pickerLayout:n.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===n.pickerLayout?new ze(e,{viewProps:this.viewProps}):null;var o=new Xi(e,{colorType:n.colorType,supportsAlpha:n.supportsAlpha,value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",r.onPopupChildBlur_),t.addEventListener("keydown",r.onPopupChildKeydown_)})),this.pickerC_=o,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(o.view.element),jn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Lt(this.foldable_,this.view.pickerElement))}return v(t,[{key:"textController",get:function(){return this.textC_}},{key:"onButtonBlur_",value:function(t){if(this.popC_){var e=this.view.element,n=w(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=yt(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!pt(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}]),t}();function eo(t,e){return Or.isColorObject(t)?Or.fromObject(t,e):Or.black(e)}function no(t){return Tr(t.getComponents("rgb")).reduce((function(t,e){return t<<8|255&Math.floor(e)}),0)}function ro(t){return t.getComponents("rgb").reduce((function(t,e,n){return t<<8|255&Math.floor(3===n?255*e:e)}),0)>>>0}function io(t){return new Or([t>>16&255,t>>8&255,255&t],"rgb")}function oo(t){return new Or([t>>24&255,t>>16&255,t>>8&255,Wn(255&t,0,255,0,1)],"rgb")}function ao(t){return"number"!==typeof t?Or.black():io(t)}function so(t){return"number"!==typeof t?Or.black():oo(t)}function lo(t){var e=Li(t);return e?function(t,n){sr(t,e(n))}:null}function uo(t){var e=t?ro:no;return function(t,n){sr(t,e(n))}}function co(t,e,n){var r=e.toRgbaObject(n);t.writeProperty("r",r.r),t.writeProperty("g",r.g),t.writeProperty("b",r.b),t.writeProperty("a",r.a)}function po(t,e,n){var r=e.toRgbaObject(n);t.writeProperty("r",r.r),t.writeProperty("g",r.g),t.writeProperty("b",r.b)}function ho(t,e){return function(n,r){t?co(n,r,e):po(n,r,e)}}function vo(t){var e;return!(!(null===t||void 0===t?void 0:t.alpha)&&!(null===(e=null===t||void 0===t?void 0:t.color)||void 0===e?void 0:e.alpha))}function fo(t){return t?function(t){return wi(t,"0x")}:function(t){return gi(t,"0x")}}function mo(t){return"color"in t||"view"in t&&"color"===t.view}var bo={id:"input-color-number",type:"input",accept:function(t,e){if("number"!==typeof t)return null;if(!mo(e))return null;var n=Gr(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return vo(t.params)?so:ao},equals:Or.equals,writer:function(t){return uo(vo(t.params))}},controller:function(t){var e=vo(t.params),n="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new to(t.document,{colorType:"int",expanded:null!==n&&void 0!==n&&n,formatter:fo(e),parser:bi("int"),pickerLayout:null!==r&&void 0!==r?r:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function _o(t){return Or.isRgbaColorObject(t)}function go(t){return function(e){return eo(e,t)}}function wo(t,e){return function(n){return t?Ai(n,e):Vi(n,e)}}var yo={id:"input-color-object",type:"input",accept:function(t,e){if(!Or.isColorObject(t))return null;var n=Gr(e);return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return go(zr(t.params))},equals:Or.equals,writer:function(t){return ho(_o(t.initialValue),zr(t.params))}},controller:function(t){var e,n=Or.isRgbaColorObject(t.initialValue),r="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0,o=null!==(e=zr(t.params))&&void 0!==e?e:"int";return new to(t.document,{colorType:o,expanded:null!==r&&void 0!==r&&r,formatter:wo(n,o),parser:bi(o),pickerLayout:null!==i&&void 0!==i?i:"popup",supportsAlpha:n,value:t.value,viewProps:t.viewProps})}},xo={id:"input-color-string",type:"input",accept:function(t,e){if("string"!==typeof t)return null;if("view"in e&&"text"===e.view)return null;var n=vi(t,zr(e));if(!n)return null;if(!Li(n))return null;var r=Gr(e);return r?{initialValue:t,params:r}:null},binding:{reader:function(t){var e;return mi(null!==(e=zr(t.params))&&void 0!==e?e:"int")},equals:Or.equals,writer:function(t){var e=vi(t.initialValue,zr(t.params));if(!e)throw P.shouldNeverHappen();var n=lo(e);if(!n)throw P.notBindable();return n}},controller:function(t){var e=vi(t.initialValue,zr(t.params));if(!e)throw P.shouldNeverHappen();var n=Li(e);if(!n)throw P.shouldNeverHappen();var r="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new to(t.document,{colorType:e.type,expanded:null!==r&&void 0!==r&&r,formatter:n,parser:bi(e.type),pickerLayout:null!==i&&void 0!==i?i:"popup",supportsAlpha:e.alpha,value:t.value,viewProps:t.viewProps})}},ko=function(){function t(e){h(this,t),this.components=e.components,this.asm_=e.assembly}return v(t,[{key:"constrain",value:function(t){var e=this,n=this.asm_.toComponents(t).map((function(t,n){var r,i;return null!==(i=null===(r=e.components[n])||void 0===r?void 0:r.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(n)}}]),t}(),Co=T("pndtxt"),Po=v((function t(e,n){var r=this;h(this,t),this.textViews=n.textViews,this.element=e.createElement("div"),this.element.classList.add(Co()),this.textViews.forEach((function(t){var n=e.createElement("div");n.classList.add(Co("a")),n.appendChild(t.element),r.element.appendChild(n)}))}));function Eo(t,e,n){return new tr(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:G(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}var Vo=v((function t(e,n){var r=this;h(this,t),this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((function(t,r){return Eo(e,n,r)})),this.acs_.forEach((function(t,e){jn({primary:r.value,secondary:t.value,forward:function(t){return n.assembly.toComponents(t.rawValue)[e]},backward:function(t,r){var i=n.assembly.toComponents(t.rawValue);return i[e]=r.rawValue,n.assembly.fromComponents(i)}})})),this.view=new Po(e,{textViews:this.acs_.map((function(t){return t.view}))})}));function So(t,e){return"step"in t&&!y(t.step)?new Oe(t.step,e):null}function Ao(t){return y(t.max)||y(t.min)?y(t.max)&&y(t.min)?null:new Ie({max:t.max,min:t.min}):new Ue({max:t.max,min:t.min})}function To(t){var e=Be(t,Ue);if(e)return[e.values.get("min"),e.values.get("max")];var n=Be(t,Ie);return n?[n.minValue,n.maxValue]:[void 0,void 0]}function Do(t,e){var n=[],r=So(t,e);r&&n.push(r);var i=Ao(t);i&&n.push(i);var o=dr(t.options);return o&&n.push(o),new Re(n)}var Lo={id:"input-number",type:"input",accept:function(t,e){if("number"!==typeof t)return null;var n=X,r=$(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(lr),step:n.optional.number});return r?{initialValue:t,params:r}:null},binding:{reader:function(t){return Mn},constraint:function(t){return Do(t.params,t.initialValue)},writer:function(t){return sr}},controller:function(t){var e,n=t.value,r=t.constraint,i=r&&Be(r,Fe);if(i)return new Ke(t.document,{props:new H({options:i.values.value("options")}),value:n,viewProps:t.viewProps});var o=null!==(e="format"in t.params?t.params.format:void 0)&&void 0!==e?e:Bn(vr(r,n.rawValue)),a=r&&Be(r,Ue);return a?new ar(t.document,{baseStep:fr(r),parser:Ln,sliderProps:new H({maxValue:a.values.value("max"),minValue:a.values.value("min")}),textProps:H.fromObject({draggingScale:mr(r,n.rawValue),formatter:o}),value:n,viewProps:t.viewProps}):new tr(t.document,{baseStep:fr(r),parser:Ln,props:H.fromObject({draggingScale:mr(r,n.rawValue),formatter:o}),value:n,viewProps:t.viewProps})}},Mo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;h(this,t),this.x=e,this.y=n}return v(t,[{key:"getComponents",value:function(){return[this.x,this.y]}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}}],[{key:"isObject",value:function(t){if(y(t))return!1;var e=t.x,n=t.y;return"number"===typeof e&&"number"===typeof n}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}}]),t}(),Ro={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return o(Mo,l(t))}},Bo=T("p2d"),Uo=v((function t(e,n){h(this,t),this.element=e.createElement("div"),this.element.classList.add(Bo()),n.viewProps.bindClassModifiers(this.element),M(n.expanded,U(this.element,Bo(void 0,"expanded")));var r=e.createElement("div");r.classList.add(Bo("h")),this.element.appendChild(r);var i=e.createElement("button");i.classList.add(Bo("b")),i.appendChild(mt(e,"p2dpad")),n.viewProps.bindDisabled(i),r.appendChild(i),this.buttonElement=i;var o=e.createElement("div");if(o.classList.add(Bo("t")),r.appendChild(o),this.textElement=o,"inline"===n.pickerLayout){var a=e.createElement("div");a.classList.add(Bo("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null})),Fo=T("p2dp"),Io=function(){function t(e,n){h(this,t),this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=n.invertsY,this.maxValue_=n.maxValue,this.element=e.createElement("div"),this.element.classList.add(Fo()),"popup"===n.layout&&this.element.classList.add(Fo(void 0,"p")),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("div");r.classList.add(Fo("p")),n.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;var i=e.createElementNS(lt,"svg");i.classList.add(Fo("g")),this.padElement.appendChild(i),this.svgElem_=i;var o=e.createElementNS(lt,"line");o.classList.add(Fo("ax")),o.setAttributeNS(null,"x1","0"),o.setAttributeNS(null,"y1","50%"),o.setAttributeNS(null,"x2","100%"),o.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(o);var a=e.createElementNS(lt,"line");a.classList.add(Fo("ax")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","0"),a.setAttributeNS(null,"x2","50%"),a.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(a);var s=e.createElementNS(lt,"line");s.classList.add(Fo("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;var l=e.createElement("div");l.classList.add(Fo("m")),this.padElement.appendChild(l),this.markerElem_=l,n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}return v(t,[{key:"allFocusableElements",get:function(){return[this.padElement]}},{key:"update_",value:function(){var t=this.value.rawValue.getComponents(),e=d(t,2),n=e[0],r=e[1],i=this.maxValue_,o=Wn(n,-i,+i,0,100),a=Wn(r,-i,+i,0,100),s=this.invertsY_?100-a:a;this.lineElem_.setAttributeNS(null,"x2","".concat(o,"%")),this.lineElem_.setAttributeNS(null,"y2","".concat(s,"%")),this.markerElem_.style.left="".concat(o,"%"),this.markerElem_.style.top="".concat(s,"%")}},{key:"onValueChange_",value:function(){this.update_()}},{key:"onFoldableChange_",value:function(){this.update_()}}]),t}();function Oo(t,e,n){return[Nn(e[0],Gn(t)),Nn(e[1],Kn(t))*(n?1:-1)]}var jo=function(){function t(e,n){h(this,t),this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.baseSteps_=n.baseSteps,this.maxValue_=n.maxValue,this.invertsY_=n.invertsY,this.view=new Io(e,{invertsY:this.invertsY_,layout:n.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zn(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}return v(t,[{key:"handlePointerEvent_",value:function(t,e){if(t.point){var n=this.maxValue_,r=Wn(t.point.x,0,t.bounds.width,-n,+n),i=Wn(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new Mo(r,i),e)}}},{key:"onPointerDown_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerMove_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}},{key:"onPointerUp_",value:function(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}},{key:"onPadKeyDown_",value:function(t){zn(t.key)&&t.preventDefault();var e=Oo(t,this.baseSteps_,this.invertsY_),n=d(e,2),r=n[0],i=n[1];0===r&&0===i||this.value.setRawValue(new Mo(this.value.rawValue.x+r,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}},{key:"onPadKeyUp_",value:function(t){var e=Oo(t,this.baseSteps_,this.invertsY_),n=d(e,2),r=n[0],i=n[1];0===r&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}]),t}(),No=function(){function t(e,n){var r,i,o=this;h(this,t),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=At.create(n.expanded),this.popC_="popup"===n.pickerLayout?new ze(e,{viewProps:this.viewProps}):null;var a=new jo(e,{baseSteps:[n.axes[0].baseStep,n.axes[1].baseStep],invertsY:n.invertsY,layout:n.pickerLayout,maxValue:n.maxValue,value:this.value,viewProps:this.viewProps});a.view.allFocusableElements.forEach((function(t){t.addEventListener("blur",o.onPopupChildBlur_),t.addEventListener("keydown",o.onPopupChildKeydown_)})),this.pickerC_=a,this.textC_=new Vo(e,{assembly:Ro,axes:n.axes,parser:n.parser,value:this.value,viewProps:this.viewProps}),this.view=new Uo(e,{expanded:this.foldable_.value("expanded"),pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),jn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:function(t){return t.rawValue},backward:function(t,e){return e.rawValue}})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Lt(this.foldable_,this.view.pickerElement))}return v(t,[{key:"onPadButtonBlur_",value:function(t){if(this.popC_){var e=this.view.element,n=w(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}}},{key:"onPadButtonClick_",value:function(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}},{key:"onPopupChildBlur_",value:function(t){if(this.popC_){var e=this.popC_.view.element,n=yt(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!pt(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}}},{key:"onPopupChildKeydown_",value:function(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}]),t}(),Ko=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;h(this,t),this.x=e,this.y=n,this.z=r}return v(t,[{key:"getComponents",value:function(){return[this.x,this.y,this.z]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z}}}],[{key:"isObject",value:function(t){if(y(t))return!1;var e=t.x,n=t.y,r=t.z;return"number"===typeof e&&"number"===typeof n&&"number"===typeof r}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}}]),t}(),Go={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return o(Ko,l(t))}};function Ho(t){return Ko.isObject(t)?new Ko(t.x,t.y,t.z):new Ko}function zo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function qo(t,e){return new ko({assembly:Go,components:[Sa("x"in t?t.x:void 0,e.x),Sa("y"in t?t.y:void 0,e.y),Sa("z"in t?t.z:void 0,e.z)]})}function Zo(t,e){return{baseStep:fr(e),constraint:e,textProps:H.fromObject({draggingScale:mr(e,t),formatter:Bn(vr(e,t))})}}var Wo={id:"input-point3d",type:"input",accept:function(t,e){if(!Ko.isObject(t))return null;var n=X,r=$(e,{x:n.optional.custom(cr),y:n.optional.custom(cr),z:n.optional.custom(cr)});return r?{initialValue:t,params:r}:null},binding:{reader:function(t){return Ho},constraint:function(t){return qo(t.params,t.initialValue)},equals:Ko.equals,writer:function(t){return zo}},controller:function(t){var e=t.value,n=t.constraint;if(!(n instanceof ko))throw P.shouldNeverHappen();return new Vo(t.document,{assembly:Go,axes:[Zo(e.rawValue.x,n.components[0]),Zo(e.rawValue.y,n.components[1]),Zo(e.rawValue.z,n.components[2])],parser:Ln,value:e,viewProps:t.viewProps})}},Yo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;h(this,t),this.x=e,this.y=n,this.z=r,this.w=i}return v(t,[{key:"getComponents",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"toObject",value:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}],[{key:"isObject",value:function(t){if(y(t))return!1;var e=t.x,n=t.y,r=t.z,i=t.w;return"number"===typeof e&&"number"===typeof n&&"number"===typeof r&&"number"===typeof i}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}}]),t}(),Xo={toComponents:function(t){return t.getComponents()},fromComponents:function(t){return o(Yo,l(t))}};function $o(t){return Yo.isObject(t)?new Yo(t.x,t.y,t.z,t.w):new Yo}function Qo(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function Jo(t,e){return new ko({assembly:Xo,components:[Sa("x"in t?t.x:void 0,e.x),Sa("y"in t?t.y:void 0,e.y),Sa("z"in t?t.z:void 0,e.z),Sa("w"in t?t.w:void 0,e.w)]})}function ta(t,e){return{baseStep:fr(e),constraint:e,textProps:H.fromObject({draggingScale:mr(e,t),formatter:Bn(vr(e,t))})}}var ea={id:"input-point4d",type:"input",accept:function(t,e){if(!Yo.isObject(t))return null;var n=X,r=$(e,{x:n.optional.custom(cr),y:n.optional.custom(cr),z:n.optional.custom(cr),w:n.optional.custom(cr)});return r?{initialValue:t,params:r}:null},binding:{reader:function(t){return $o},constraint:function(t){return Jo(t.params,t.initialValue)},equals:Yo.equals,writer:function(t){return Qo}},controller:function(t){var e=t.value,n=t.constraint;if(!(n instanceof ko))throw P.shouldNeverHappen();return new Vo(t.document,{assembly:Xo,axes:e.rawValue.getComponents().map((function(t,e){return ta(t,n.components[e])})),parser:Ln,value:e,viewProps:t.viewProps})}};function na(t){var e=[],n=dr(t.options);return n&&e.push(n),new Re(e)}var ra={id:"input-string",type:"input",accept:function(t,e){if("string"!==typeof t)return null;var n=$(e,{options:X.optional.custom(lr)});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return In},constraint:function(t){return na(t.params)},writer:function(t){return sr}},controller:function(t){var e=t.document,n=t.value,r=t.constraint,i=r&&Be(r,Fe);return i?new Ke(e,{props:new H({options:i.values.value("options")}),value:n,viewProps:t.viewProps}):new We(e,{parser:function(t){return t},props:H.fromObject({formatter:On}),value:n,viewProps:t.viewProps})}},ia={monitor:{defaultInterval:200,defaultLineCount:3}},oa=T("mll"),aa=function(){function t(e,n){h(this,t),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(oa()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("textarea");r.classList.add(oa("i")),r.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),r.readOnly=!0,n.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return v(t,[{key:"update_",value:function(){var t=this,e=this.textareaElem_,n=e.scrollTop===e.scrollHeight-e.clientHeight,r=[];this.value.rawValue.forEach((function(e){void 0!==e&&r.push(t.formatter_(e))})),e.textContent=r.join("\n"),n&&(e.scrollTop=e.scrollHeight)}},{key:"onValueUpdate_",value:function(){this.update_()}}]),t}(),sa=v((function t(e,n){h(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new aa(e,{formatter:n.formatter,lineCount:n.lineCount,value:this.value,viewProps:this.viewProps})})),la=T("sgl"),ua=function(){function t(e,n){h(this,t),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(la()),n.viewProps.bindClassModifiers(this.element);var r=e.createElement("input");r.classList.add(la("i")),r.readOnly=!0,r.type="text",n.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return v(t,[{key:"update_",value:function(){var t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}},{key:"onValueUpdate_",value:function(){this.update_()}}]),t}(),ca=v((function t(e,n){h(this,t),this.value=n.value,this.viewProps=n.viewProps,this.view=new ua(e,{formatter:n.formatter,value:this.value,viewProps:this.viewProps})})),pa={id:"monitor-bool",type:"monitor",accept:function(t,e){if("boolean"!==typeof t)return null;var n=$(e,{lineCount:X.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:function(t){return Xe}},controller:function(t){var e;return 1===t.value.rawValue.length?new ca(t.document,{formatter:$e,value:t.value,viewProps:t.viewProps}):new sa(t.document,{formatter:$e,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ia.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},da=T("grl"),ha=function(){function t(e,n){h(this,t),this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(da()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.props_=n.props,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);var r=e.createElementNS(lt,"svg");r.classList.add(da("g")),r.style.height="calc(var(--bld-us) * ".concat(n.lineCount,")"),this.element.appendChild(r),this.svgElem_=r;var i=e.createElementNS(lt,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;var o=e.createElement("div");o.classList.add(da("t"),T("tt")()),this.element.appendChild(o),this.tooltipElem_=o,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}return v(t,[{key:"graphElement",get:function(){return this.svgElem_}},{key:"update_",value:function(){var t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.props_.get("minValue"),r=this.props_.get("maxValue"),i=[];this.value.rawValue.forEach((function(o,a){if(void 0!==o){var s=Wn(a,0,e,0,t.width),l=Wn(o,n,r,t.height,0);i.push([s,l].join(","))}})),this.lineElem_.setAttributeNS(null,"points",i.join(" "));var o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0!==a){var s=Wn(this.cursor_.rawValue,0,e,0,t.width),l=Wn(a,n,r,t.height,0);o.style.left="".concat(s,"px"),o.style.top="".concat(l,"px"),o.textContent="".concat(this.formatter_(a)),o.classList.contains(da("t","a"))||(o.classList.add(da("t","a"),da("t","in")),ut(o),o.classList.remove(da("t","in")))}else o.classList.remove(da("t","a"))}},{key:"onValueUpdate_",value:function(){this.update_()}},{key:"onCursorChange_",value:function(){this.update_()}}]),t}(),va=function(){function t(e,n){if(h(this,t),this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=n.props,this.value=n.value,this.viewProps=n.viewProps,this.cursor_=G(-1),this.view=new ha(e,{cursor:this.cursor_,formatter:n.formatter,lineCount:n.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),pt(e)){var r=new Zn(this.view.element);r.emitter.on("down",this.onGraphPointerDown_),r.emitter.on("move",this.onGraphPointerMove_),r.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}return v(t,[{key:"onGraphMouseLeave_",value:function(){this.cursor_.rawValue=-1}},{key:"onGraphMouseMove_",value:function(t){var e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Wn(t.offsetX,0,e.width,0,this.value.rawValue.length))}},{key:"onGraphPointerDown_",value:function(t){this.onGraphPointerMove_(t)}},{key:"onGraphPointerMove_",value:function(t){t.data.point?this.cursor_.rawValue=Math.floor(Wn(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}},{key:"onGraphPointerUp_",value:function(){this.cursor_.rawValue=-1}}]),t}();function fa(t){return"format"in t&&!y(t.format)?t.format:Bn(2)}function ma(t){var e;return 1===t.value.rawValue.length?new ca(t.document,{formatter:fa(t.params),value:t.value,viewProps:t.viewProps}):new sa(t.document,{formatter:fa(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ia.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function ba(t){var e,n,r;return new va(t.document,{formatter:fa(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ia.monitor.defaultLineCount,props:H.fromObject({maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(r="min"in t.params?t.params.min:null)&&void 0!==r?r:0}),value:t.value,viewProps:t.viewProps})}function _a(t){return"view"in t&&"graph"===t.view}var ga={id:"monitor-number",type:"monitor",accept:function(t,e){if("number"!==typeof t)return null;var n=X,r=$(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return r?{initialValue:t,params:r}:null},binding:{defaultBufferSize:function(t){return _a(t)?64:1},reader:function(t){return Mn}},controller:function(t){return _a(t.params)?ba(t):ma(t)}},wa={id:"monitor-string",type:"monitor",accept:function(t,e){if("string"!==typeof t)return null;var n=X,r=$(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return r?{initialValue:t,params:r}:null},binding:{reader:function(t){return In}},controller:function(t){var e,n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new sa(t.document,{formatter:On,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ia.monitor.defaultLineCount,value:n,viewProps:t.viewProps}):new ca(t.document,{formatter:On,value:n,viewProps:t.viewProps})}};function ya(t,e){var n,r=t.accept(e.target.read(),e.params);if(y(r))return null;var i=X,o={target:e.target,initialValue:r.initialValue,params:r.params},a=t.binding.reader(o),s=t.binding.constraint?t.binding.constraint(o):void 0,l=G(a(r.initialValue),{constraint:s,equals:t.binding.equals}),u=new Se({reader:a,target:e.target,value:l,writer:t.binding.writer(o)}),c=i.optional.boolean(e.params.disabled).value,p=i.optional.boolean(e.params.hidden).value,d=t.controller({constraint:s,document:e.document,initialValue:r.initialValue,params:r.params,value:u.value,viewProps:rt.create({disabled:c,hidden:p})});return new jt(e.document,{binding:u,blade:St(),props:H.fromObject({label:"label"in e.params?null!==(n=i.optional.string(e.params.label).value)&&void 0!==n?n:null:e.target.key}),valueController:d})}function xa(t,e){return 0===e?new Ee:new Ve(t,null!==e&&void 0!==e?e:ia.monitor.defaultInterval)}function ka(t,e){var n,r,i,o=X,a=t.accept(e.target.read(),e.params);if(y(a))return null;var s={target:e.target,initialValue:a.initialValue,params:a.params},l=t.binding.reader(s),u=null!==(r=null!==(n=o.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(a.params))&&void 0!==r?r:1,c=o.optional.number(e.params.interval).value,p=new Me({reader:l,target:e.target,ticker:xa(e.document,c),value:Te(u)}),d=o.optional.boolean(e.params.disabled).value,h=o.optional.boolean(e.params.hidden).value,v=t.controller({document:e.document,params:a.params,value:p.value,viewProps:rt.create({disabled:d,hidden:h})});return new Kt(e.document,{binding:p,blade:St(),props:H.fromObject({label:"label"in e.params?null!==(i=o.optional.string(e.params.label).value)&&void 0!==i?i:null:e.target.key}),valueController:v})}var Ca=function(){function t(){h(this,t),this.pluginsMap_={blades:[],inputs:[],monitors:[]}}return v(t,[{key:"getAll",value:function(){return[].concat(l(this.pluginsMap_.blades),l(this.pluginsMap_.inputs),l(this.pluginsMap_.monitors))}},{key:"register",value:function(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}},{key:"createInput",value:function(t,e,n){if(y(e.read()))throw new P({context:{key:e.key},type:"nomatchingcontroller"});var r=this.pluginsMap_.inputs.reduce((function(r,i){return null!==r&&void 0!==r?r:ya(i,{document:t,target:e,params:n})}),null);if(r)return r;throw new P({context:{key:e.key},type:"nomatchingcontroller"})}},{key:"createMonitor",value:function(t,e,n){var r=this.pluginsMap_.monitors.reduce((function(r,i){return null!==r&&void 0!==r?r:ka(i,{document:t,params:n,target:e})}),null);if(r)return r;throw new P({context:{key:e.key},type:"nomatchingcontroller"})}},{key:"createBlade",value:function(t,e){var n=this.pluginsMap_.blades.reduce((function(n,r){return null!==n&&void 0!==n?n:Pe(r,{document:t,params:e})}),null);if(!n)throw new P({type:"nomatchingview",context:{params:e}});return n}},{key:"createBladeApi",value:function(t){var e=this;if(t instanceof jt)return new Ot(t);if(t instanceof Kt)return new Nt(t);if(t instanceof ne)return new qt(t,this);var n=this.pluginsMap_.blades.reduce((function(n,r){return null!==n&&void 0!==n?n:r.api({controller:t,pool:e})}),null);if(!n)throw P.shouldNeverHappen();return n}}]),t}();function Pa(){var t=new Ca;return[Ra,Wo,ea,ra,Lo,xo,yo,bo,yr,pa,wa,ga,Et,ae,de,Ce].forEach((function(e){t.register(e)})),t}function Ea(t){return Mo.isObject(t)?new Mo(t.x,t.y):new Mo}function Va(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function Sa(t,e){if(t){var n=[],r=So(t,e);r&&n.push(r);var i=Ao(t);return i&&n.push(i),new Re(n)}}function Aa(t,e){return new ko({assembly:Ro,components:[Sa("x"in t?t.x:void 0,e.x),Sa("y"in t?t.y:void 0,e.y)]})}function Ta(t,e){var n=t?To(t):[],r=d(n,2),i=r[0],o=r[1];if(!y(i)||!y(o))return Math.max(Math.abs(null!==i&&void 0!==i?i:0),Math.abs(null!==o&&void 0!==o?o:0));var a=fr(t);return Math.max(10*Math.abs(a),10*Math.abs(e))}function Da(t,e){var n=e instanceof ko?e.components[0]:void 0,r=e instanceof ko?e.components[1]:void 0,i=Ta(n,t.x),o=Ta(r,t.y);return Math.max(i,o)}function La(t,e){return{baseStep:fr(e),constraint:e,textProps:H.fromObject({draggingScale:mr(e,t),formatter:Bn(vr(e,t))})}}function Ma(t){if(!("y"in t))return!1;var e=t.y;return!!e&&"inverted"in e&&!!e.inverted}var Ra={id:"input-point2d",type:"input",accept:function(t,e){if(!Mo.isObject(t))return null;var n=X,r=$(e,{expanded:n.optional.boolean,picker:n.optional.custom(ur),x:n.optional.custom(cr),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return r?{initialValue:t,params:r}:null},binding:{reader:function(t){return Ea},constraint:function(t){return Aa(t.params,t.initialValue)},equals:Mo.equals,writer:function(t){return Va}},controller:function(t){var e=t.document,n=t.value,r=t.constraint;if(!(r instanceof ko))throw P.shouldNeverHappen();var i="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new No(e,{axes:[La(n.rawValue.x,r.components[0]),La(n.rawValue.y,r.components[1])],expanded:null!==i&&void 0!==i&&i,invertsY:Ma(t.params),maxValue:Da(n.rawValue,r),parser:Ln,pickerLayout:null!==o&&void 0!==o?o:"popup",value:n,viewProps:t.viewProps})}},Ba=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,t)).emitter_=new S,r.controller_.valueController.value.emitter.on("change",(function(t){r.emitter_.emit("change",{event:new m(s(r),t.rawValue)})})),r}return v(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"options",get:function(){return this.controller_.valueController.props.get("options")},set:function(t){this.controller_.valueController.props.set("options",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),Ua=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,t)).emitter_=new S,r.controller_.valueController.value.emitter.on("change",(function(t){r.emitter_.emit("change",{event:new m(s(r),t.rawValue)})})),r}return v(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"maxValue",get:function(){return this.controller_.valueController.sliderController.props.get("maxValue")},set:function(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}},{key:"minValue",get:function(){return this.controller_.valueController.sliderController.props.get("minValue")},set:function(t){this.controller_.valueController.sliderController.props.set("minValue",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),Fa=function(t){c(n,t);var e=p(n);function n(t){var r;return h(this,n),(r=e.call(this,t)).emitter_=new S,r.controller_.valueController.value.emitter.on("change",(function(t){r.emitter_.emit("change",{event:new m(s(r),t.rawValue)})})),r}return v(n,[{key:"label",get:function(){return this.controller_.props.get("label")},set:function(t){this.controller_.props.set("label",t)}},{key:"formatter",get:function(){return this.controller_.valueController.props.get("formatter")},set:function(t){this.controller_.valueController.props.set("formatter",t)}},{key:"value",get:function(){return this.controller_.valueController.value.rawValue},set:function(t){this.controller_.valueController.value.rawValue=t}},{key:"on",value:function(t,e){var n=e.bind(this);return this.emitter_.on(t,(function(t){n(t.event)})),this}}]),n}(n),Ia={id:"list",type:"blade",accept:function(t){var e=X,n=$(t,{options:e.required.custom(lr),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller:function(t){var e=new Fe(pr(t.params.options)),n=G(t.params.value,{constraint:e}),r=new Ke(t.document,{props:new H({options:e.values.value("options")}),value:n,viewProps:t.viewProps});return new se(t.document,{blade:t.blade,props:H.fromObject({label:t.params.label}),valueController:r})},api:function(t){return t.controller instanceof se&&t.controller.valueController instanceof Ke?new Ba(t.controller):null}};function Oa(t){return t.reduce((function(t,e){return Object.assign(t,u({},e.presetKey,e.read()))}),{})}function ja(t,e){t.forEach((function(t){var n=e[t.target.presetKey];void 0!==n&&t.writer(t.target,t.reader(n))}))}var Na=function(t){c(n,t);var e=p(n);function n(t,r){return h(this,n),e.call(this,t,r)}return v(n,[{key:"element",get:function(){return this.controller_.view.element}},{key:"importPreset",value:function(t){ja(this.controller_.rackController.rack.find(jt).map((function(t){return t.binding})),t),this.refresh()}},{key:"exportPreset",value:function(){return Oa(this.controller_.rackController.rack.find(jt).map((function(t){return t.binding.target})))}},{key:"refresh",value:function(){this.controller_.rackController.rack.find(jt).forEach((function(t){t.binding.read()})),this.controller_.rackController.rack.find(Kt).forEach((function(t){t.binding.read()}))}}]),n}(Zt),Ka=function(t){c(n,t);var e=p(n);function n(t,r){return h(this,n),e.call(this,t,{expanded:r.expanded,blade:r.blade,props:r.props,root:!0,viewProps:r.viewProps})}return v(n)}(oe),Ga={id:"slider",type:"blade",accept:function(t){var e=X,n=$(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller:function(t){var e,n,r=null!==(e=t.params.value)&&void 0!==e?e:0,i=new Ue({max:t.params.max,min:t.params.min}),o=new ar(t.document,{baseStep:1,parser:Ln,sliderProps:new H({maxValue:i.values.value("max"),minValue:i.values.value("min")}),textProps:H.fromObject({draggingScale:mr(void 0,r),formatter:null!==(n=t.params.format)&&void 0!==n?n:Rn}),value:G(r,{constraint:i}),viewProps:t.viewProps});return new se(t.document,{blade:t.blade,props:H.fromObject({label:t.params.label}),valueController:o})},api:function(t){return t.controller instanceof se&&t.controller.valueController instanceof ar?new Ua(t.controller):null}},Ha={id:"text",type:"blade",accept:function(t){var e=X,n=$(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller:function(t){var e,n=new We(t.document,{parser:t.params.parse,props:H.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:function(t){return String(t)}}),value:G(t.params.value),viewProps:t.viewProps});return new se(t.document,{blade:t.blade,props:H.fromObject({label:t.params.label}),valueController:n})},api:function(t){return t.controller instanceof se&&t.controller.valueController instanceof We?new Fa(t.controller):null}};function za(t){var e=t.createElement("div");return e.classList.add(T("dfw")()),t.body&&t.body.appendChild(e),e}function qa(t,e,n){if(!t.querySelector("style[data-tp-style=".concat(e,"]"))){var r=t.createElement("style");r.dataset.tpStyle=e,r.textContent=n,t.head.appendChild(r)}}var Za=function(t){c(n,t);var e=p(n);function n(t){var r,i,o;h(this,n);var a=null!==t&&void 0!==t?t:{},s=null!==(i=a.document)&&void 0!==i?i:ht(),l=Pa(),u=new Ka(s,{expanded:a.expanded,blade:St(),props:H.fromObject({title:a.title}),viewProps:rt.create()});return(r=e.call(this,u,l)).pool_=l,r.containerElem_=null!==(o=a.container)&&void 0!==o?o:za(s),r.containerElem_.appendChild(r.element),r.doc_=s,r.usesDefaultWrapper_=!a.container,r.setUpDefaultPlugins_(),r}return v(n,[{key:"document",get:function(){if(!this.doc_)throw P.alreadyDisposed();return this.doc_}},{key:"dispose",value:function(){var t=this.containerElem_;if(!t)throw P.alreadyDisposed();if(this.usesDefaultWrapper_){var e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,r(i(n.prototype),"dispose",this).call(this)}},{key:"registerPlugin",value:function(t){var e=this;("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((function(t){e.pool_.register(t),e.embedPluginStyle_(t)}))}},{key:"embedPluginStyle_",value:function(t){t.css&&qa(this.document,"plugin-".concat(t.id),t.css)}},{key:"setUpDefaultPlugins_",value:function(){var t=this;qa(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((function(e){t.embedPluginStyle_(e)})),this.registerPlugin({plugins:[Ga,Ia,Ce,Ha]})}}]),n}(Na),Wa=new e("3.1.10");t.BladeApi=n,t.ButtonApi=V,t.FolderApi=Zt,t.InputBindingApi=Ot,t.ListApi=Ba,t.MonitorBindingApi=Nt,t.Pane=Za,t.SeparatorApi=le,t.SliderApi=Ua,t.TabApi=_e,t.TabPageApi=be,t.TextApi=Fa,t.TpChangeEvent=m,t.VERSION=Wa,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2982:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(907);var i=n(181);function o(t){return function(t){if(Array.isArray(t))return(0,r.Z)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,i.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6900:function(t,e,n){"use strict";n.d(e,{g:function(){return p}});var r=n(885),i=n(1413),o=n(5671),a=n(3144),s=n(136),l=n(9388),u=n(3562),c=new WeakMap,p=function(t){(0,s.Z)(n,t);var e=(0,l.Z)(n);function n(t){var r;return(0,o.Z)(this,n),(r=e.call(this,t)).transcoderPath="",r.transcoderBinary=null,r.transcoderPending=null,r.workerLimit=4,r.workerPool=[],r.workerNextTaskID=1,r.workerSourceURL="",r.workerConfig=null,r}return(0,a.Z)(n,[{key:"setTranscoderPath",value:function(t){return this.transcoderPath=t,this}},{key:"setWorkerLimit",value:function(t){return this.workerLimit=t,this}},{key:"detectSupport",value:function(t){return this.workerConfig={astcSupported:t.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:t.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:t.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:t.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:t.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:t.extensions.has("WEBGL_compressed_texture_pvrtc")||t.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}},{key:"load",value:function(t,e,n,r){var i=this,o=new u.hH6(this.manager);o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials);var a=new u.EB7;return o.load(t,(function(t){if(c.has(t))return c.get(t).promise.then(e).catch(r);i._createTexture([t]).then((function(t){a.copy(t),a.needsUpdate=!0,e&&e(a)})).catch(r)}),n,r),a}},{key:"parseInternalAsync",value:function(t){for(var e=t.levels,n=new Set,r=0;r<e.length;r++)n.add(e[r].data.buffer);return this._createTexture(Array.from(n),(0,i.Z)((0,i.Z)({},t),{},{lowLevel:!0}))}},{key:"_createTexture",value:function(t){for(var e,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i,a=0,s=0;s<t.length;s++)a+=t[s].byteLength;var l=this._allocateWorker(a).then((function(i){return e=i,n=r.workerNextTaskID++,new Promise((function(r,i){e._callbacks[n]={resolve:r,reject:i},e.postMessage({type:"transcode",id:n,buffers:t,taskConfig:o},t)}))})).then((function(t){var e=t.mipmaps,n=t.width,r=t.height,i=t.format,o=new u.EB7(e,n,r,i,u.ywz);return o.minFilter=1===e.length?u.wem:u.D1R,o.magFilter=u.wem,o.generateMipmaps=!1,o.needsUpdate=!0,o}));return l.catch((function(){return!0})).then((function(){e&&n&&(e._taskLoad-=a,delete e._callbacks[n])})),c.set(t[0],{promise:l}),l}},{key:"_initTranscoder",value:function(){var t=this;if(!this.transcoderPending){var e=new u.hH6(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);var i=new Promise((function(t,n){e.load("basis_transcoder.js",t,void 0,n)})),o=new u.hH6(this.manager);o.setPath(this.transcoderPath),o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials);var a=new Promise((function(t,e){o.load("basis_transcoder.wasm",t,void 0,e)}));this.transcoderPending=Promise.all([i,a]).then((function(e){var i=(0,r.Z)(e,2),o=i[0],a=i[1],s=n.BasisWorker.toString(),l=["/* constants */","let _EngineFormat = "+JSON.stringify(n.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(n.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(n.BasisFormat),"/* basis_transcoder.js */",o,"/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");t.workerSourceURL=URL.createObjectURL(new Blob([l])),t.transcoderBinary=a}))}return this.transcoderPending}},{key:"_allocateWorker",value:function(t){var e=this;return this._initTranscoder().then((function(){if(e.workerPool.length<e.workerLimit){var n=new Worker(e.workerSourceURL);n._callbacks={},n._taskLoad=0,n.postMessage({type:"init",config:e.workerConfig,transcoderBinary:e.transcoderBinary}),n.onmessage=function(t){var e=t.data;switch(e.type){case"transcode":n._callbacks[e.id].resolve(e);break;case"error":n._callbacks[e.id].reject(e);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+e.type+'"')}},e.workerPool.push(n)}else e.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1}));var r=e.workerPool[e.workerPool.length-1];return r._taskLoad+=t,r}))}},{key:"dispose",value:function(){for(var t=0;t<this.workerPool.length;t++)this.workerPool[t].terminate();return this.workerPool.length=0,this}}]),n}(u.aNw);p.BasisFormat={ETC1S:0,UASTC_4x4:1},p.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},p.EngineFormat={RGBAFormat:u.wk1,RGBA_ASTC_4x4_Format:u.ptH,RGBA_BPTC_Format:u.bsb,RGBA_ETC2_EAC_Format:u.ekQ,RGBA_PVRTC_4BPPV1_Format:u.eaV,RGBA_S3TC_DXT5_Format:u.ILR,RGB_ETC1_Format:u.fto,RGB_ETC2_Format:u.l0P,RGB_PVRTC_4BPPV1_Format:u._AM,RGB_S3TC_DXT1_Format:u.wuA},p.BasisWorker=function(){var t,e,n,r=_EngineFormat,i=_TranscoderFormat,o=_BasisFormat;onmessage=function(r){var i,a=r.data;switch(a.type){case"init":t=a.config,i=a.transcoderBinary,e=new Promise((function(t){n={wasmBinary:i,onRuntimeInitialized:t},BASIS(n)})).then((function(){n.initializeBasis()}));break;case"transcode":e.then((function(){try{for(var t=a.taskConfig.lowLevel?function(t){var e=t.basisFormat,r=t.width,i=t.height,a=t.hasAlpha,s=u(e,r,i,a),l=s.transcoderFormat,v=s.engineFormat,f=n.getBytesPerBlockOrPixel(l);c(n.isFormatSupported(l),"THREE.BasisTextureLoader: Unsupported format.");var m=[];if(e===o.ETC1S){var b=new n.LowLevelETC1SImageTranscoder,_=t.globalData,g=_.endpointCount,w=_.endpointsData,y=_.selectorCount,x=_.selectorsData,k=_.tablesData;try{c(b.decodePalettes(g,w,y,x),"THREE.BasisTextureLoader: decodePalettes() failed."),c(b.decodeTables(k),"THREE.BasisTextureLoader: decodeTables() failed.");for(var C=0;C<t.levels.length;C++){var P=t.levels[C],E=t.globalData.imageDescs[C],V=h(l,P.width,P.height),S=new Uint8Array(V);c(b.transcodeImage(l,S,V/f,P.data,p(l,P.width),d(l,P.height),P.width,P.height,P.index,E.rgbSliceByteOffset,E.rgbSliceByteLength,E.alphaSliceByteOffset,E.alphaSliceByteLength,E.imageFlags,a,!1,0,0),"THREE.BasisTextureLoader: transcodeImage() failed for level "+P.index+"."),m.push({data:S,width:P.width,height:P.height})}}finally{b.delete()}}else for(var A=0;A<t.levels.length;A++){var T=t.levels[A],D=h(l,T.width,T.height),L=new Uint8Array(D);c(n.transcodeUASTCImage(l,L,D/f,T.data,p(l,T.width),d(l,T.height),T.width,T.height,T.index,0,T.data.byteLength,0,a,!1,0,0,-1,-1),"THREE.BasisTextureLoader: transcodeUASTCImage() failed for level "+T.index+"."),m.push({data:L,width:T.width,height:T.height})}return{width:r,height:i,hasAlpha:a,mipmaps:m,format:v}}(a.taskConfig):function(t){var e=new n.BasisFile(new Uint8Array(t)),r=e.isUASTC()?o.UASTC_4x4:o.ETC1S,i=e.getImageWidth(0,0),a=e.getImageHeight(0,0),s=e.getNumLevels(0),l=e.getHasAlpha();function c(){e.close(),e.delete()}var p=u(r,i,a,l),d=p.transcoderFormat,h=p.engineFormat;if(!i||!a||!s)throw c(),new Error("THREE.BasisTextureLoader:\tInvalid texture");if(!e.startTranscoding())throw c(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");for(var v=[],f=0;f<s;f++){var m=e.getImageWidth(0,f),b=e.getImageHeight(0,f),_=new Uint8Array(e.getImageTranscodedSizeInBytes(0,f,d));if(!e.transcodeImage(_,0,f,d,0,l))throw c(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");v.push({data:_,width:m,height:b})}return c(),{width:i,height:a,hasAlpha:l,mipmaps:v,format:h}}(a.buffers[0]),e=t.width,r=t.height,i=t.hasAlpha,s=t.mipmaps,l=t.format,v=[],f=0;f<s.length;++f)v.push(s[f].data.buffer);self.postMessage({type:"transcode",id:a.id,width:e,height:r,hasAlpha:i,mipmaps:s,format:l},v)}catch(m){console.error(m),self.postMessage({type:"error",id:a.id,error:m.message})}}))}};var a=[{if:"astcSupported",basisFormat:[o.UASTC_4x4],transcoderFormat:[i.ASTC_4x4,i.ASTC_4x4],engineFormat:[r.RGBA_ASTC_4x4_Format,r.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.BC7_M5,i.BC7_M5],engineFormat:[r.RGBA_BPTC_Format,r.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.BC1,i.BC3],engineFormat:[r.RGB_S3TC_DXT1_Format,r.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC2],engineFormat:[r.RGB_ETC2_Format,r.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC1],engineFormat:[r.RGB_ETC1_Format,r.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.PVRTC1_4_RGB,i.PVRTC1_4_RGBA],engineFormat:[r.RGB_PVRTC_4BPPV1_Format,r.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],s=a.sort((function(t,e){return t.priorityETC1S-e.priorityETC1S})),l=a.sort((function(t,e){return t.priorityUASTC-e.priorityUASTC}));function u(e,n,a,u){for(var c=e===o.ETC1S?s:l,p=0;p<c.length;p++){var d=c[p];if(t[d.if]&&(d.basisFormat.includes(e)&&(!d.needsPowerOfTwo||v(n)&&v(a))))return{transcoderFormat:d.transcoderFormat[u?1:0],engineFormat:d.engineFormat[u?1:0]}}return console.warn("THREE.BasisTextureLoader: No suitable compressed texture format found. Decoding to RGBA32."),{transcoderFormat:i.RGBA32,engineFormat:r.RGBAFormat}}function c(t,e){if(!t)throw new Error(e)}function p(t,e){return Math.ceil(e/n.getFormatBlockWidth(t))}function d(t,e){return Math.ceil(e/n.getFormatBlockHeight(t))}function h(t,e,r){var o=n.getBytesPerBlockOrPixel(t);if(n.formatIsUncompressed(t))return e*r*o;if(t===i.PVRTC1_4_RGB||t===i.PVRTC1_4_RGBA){var a=e+3&-4,s=r+3&-4;return(Math.max(8,a)*Math.max(8,s)*4+7)/8}return p(t,e)*d(t,r)*o}function v(t){return t<=2||0===(t&t-1)&&0!==t}}},4849:function(t,e,n){"use strict";n.d(e,{_:function(){return u}});var r=n(5671),i=n(3144),o=n(136),a=n(9388),s=n(3562),l=new WeakMap,u=function(t){(0,o.Z)(n,t);var e=(0,a.Z)(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).decoderPath="",i.decoderConfig={},i.decoderBinary=null,i.decoderPending=null,i.workerLimit=4,i.workerPool=[],i.workerNextTaskID=1,i.workerSourceURL="",i.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},i.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},i}return(0,i.Z)(n,[{key:"setDecoderPath",value:function(t){return this.decoderPath=t,this}},{key:"setDecoderConfig",value:function(t){return this.decoderConfig=t,this}},{key:"setWorkerLimit",value:function(t){return this.workerLimit=t,this}},{key:"load",value:function(t,e,n,r){var i=this,o=new s.hH6(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(t){var n={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(t,n).then(e).catch(r)}),n,r)}},{key:"decodeDracoFile",value:function(t,e,n,r){var i={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(t,i).then(e)}},{key:"decodeGeometry",value:function(t,e){var n=this;for(var r in e.attributeTypes){var i=e.attributeTypes[r];void 0!==i.BYTES_PER_ELEMENT&&(e.attributeTypes[r]=i.name)}var o,a=JSON.stringify(e);if(l.has(t)){var s=l.get(t);if(s.key===a)return s.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var u=this.workerNextTaskID++,c=t.byteLength,p=this._getWorker(u,c).then((function(n){return o=n,new Promise((function(n,r){o._callbacks[u]={resolve:n,reject:r},o.postMessage({type:"decode",id:u,taskConfig:e,buffer:t},[t])}))})).then((function(t){return n._createGeometry(t.geometry)}));return p.catch((function(){return!0})).then((function(){o&&u&&n._releaseTask(o,u)})),l.set(t,{key:a,promise:p}),p}},{key:"_createGeometry",value:function(t){var e=new s.u9r;t.index&&e.setIndex(new s.TlE(t.index.array,1));for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n],i=r.name,o=r.array,a=r.itemSize;e.setAttribute(i,new s.TlE(o,a))}return e}},{key:"_loadLibrary",value:function(t,e){var n=new s.hH6(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),n.setWithCredentials(this.withCredentials),new Promise((function(e,r){n.load(t,e,void 0,r)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var t=this;if(this.decoderPending)return this.decoderPending;var e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(n){var r=n[0];e||(t.decoderConfig.wasmBinary=n[1]);var i=c.toString(),o=["/* draco decoder */",r,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");t.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending}},{key:"_getWorker",value:function(t,e){var n=this;return this._initDecoder().then((function(){if(n.workerPool.length<n.workerLimit){var r=new Worker(n.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:n.decoderConfig}),r.onmessage=function(t){var e=t.data;switch(e.type){case"decode":r._callbacks[e.id].resolve(e);break;case"error":r._callbacks[e.id].reject(e);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+e.type+'"')}},n.workerPool.push(r)}else n.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1}));var i=n.workerPool[n.workerPool.length-1];return i._taskCosts[t]=e,i._taskLoad+=e,i}))}},{key:"_releaseTask",value:function(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(t){return t._taskLoad})))}},{key:"dispose",value:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}]),n}(s.aNw);function c(){var t,e;function n(t,e,n,r,i,o){var a=o.num_components(),s=n.num_points()*a,l=s*i.BYTES_PER_ELEMENT,u=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,i),c=t._malloc(l);e.GetAttributeDataArrayForAllPoints(n,o,u,l,c);var p=new i(t.HEAPF32.buffer,c,s).slice();return t._free(c),{name:r,array:p,itemSize:a}}onmessage=function(r){var i=r.data;switch(i.type){case"init":t=i.decoderConfig,e=new Promise((function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)}));break;case"decode":var o=i.buffer,a=i.taskConfig;e.then((function(t){var e=t.draco,r=new e.Decoder,s=new e.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var l=function(t,e,r,i){var o,a,s=i.attributeIDs,l=i.attributeTypes,u=e.GetEncodedGeometryType(r);if(u===t.TRIANGULAR_MESH)o=new t.Mesh,a=e.DecodeBufferToMesh(r,o);else{if(u!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new t.PointCloud,a=e.DecodeBufferToPointCloud(r,o)}if(!a.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var c={index:null,attributes:[]};for(var p in s){var d=self[l[p]],h=void 0,v=void 0;if(i.useUniqueIDs)v=s[p],h=e.GetAttributeByUniqueId(o,v);else{if(-1===(v=e.GetAttributeId(o,t[s[p]])))continue;h=e.GetAttribute(o,v)}c.attributes.push(n(t,e,o,p,d,h))}u===t.TRIANGULAR_MESH&&(c.index=function(t,e,n){var r=3*n.num_faces(),i=4*r,o=t._malloc(i);e.GetTrianglesUInt32Array(n,i,o);var a=new Uint32Array(t.HEAPF32.buffer,o,r).slice();return t._free(o),{array:a,itemSize:1}}(t,e,o));return t.destroy(o),c}(e,r,s,a),u=l.attributes.map((function(t){return t.array.buffer}));l.index&&u.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},u)}catch(c){console.error(c),self.postMessage({type:"error",id:i.id,error:c.message})}finally{e.destroy(s),e.destroy(r)}}))}}}},598:function(t,e,n){"use strict";n.d(e,{x:function(){return c}});var r=n(5671),i=n(3144),o=n(1752),a=n(1120),s=n(136),l=n(9388),u=n(3562),c=function(t){(0,s.Z)(n,t);var e=(0,l.Z)(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).type=u.cLu,i}return(0,i.Z)(n,[{key:"parse",value:function(t){var e=function(t,e){switch(t){case 1:console.error("THREE.RGBELoader Read Error: "+(e||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(e||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(e||""));break;default:console.error("THREE.RGBELoader: Error: "+(e||""))}return-1},n=function(t,e,n){e=e||1024;for(var r=t.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(t.subarray(r,r+128)));0>(i=s.indexOf("\n"))&&o<e&&r<t.byteLength;)a+=s,o+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(r,r+128)));return-1<i&&(!1!==n&&(t.pos+=o+i+1),a+s.slice(0,i))},r=function(t,e,n,r){var i=t[e+3],o=Math.pow(2,i-128)/255;n[r+0]=t[e+0]*o,n[r+1]=t[e+1]*o,n[r+2]=t[e+2]*o},i=function(t,e,n,r){var i=t[e+3],o=Math.pow(2,i-128)/255;n[r+0]=u.A5E.toHalfFloat(Math.min(t[e+0]*o,65504)),n[r+1]=u.A5E.toHalfFloat(Math.min(t[e+1]*o,65504)),n[r+2]=u.A5E.toHalfFloat(Math.min(t[e+2]*o,65504))},o=new Uint8Array(t);o.pos=0;var a=function(t){var r,i,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(r=n(t)))return e(1,"no header found");if(!(i=r.match(/^#\?(\S+)/)))return e(3,"bad initial token");for(u.valid|=1,u.programtype=i[1],u.string+=r+"\n";!1!==(r=n(t));)if(u.string+=r+"\n","#"!==r.charAt(0)){if((i=r.match(o))&&(u.gamma=parseFloat(i[1],10)),(i=r.match(a))&&(u.exposure=parseFloat(i[1],10)),(i=r.match(s))&&(u.valid|=2,u.format=i[1]),(i=r.match(l))&&(u.valid|=4,u.height=parseInt(i[1],10),u.width=parseInt(i[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=r+"\n";return 2&u.valid?4&u.valid?u:e(3,"missing image size specifier"):e(3,"missing format specifier")}(o);if(-1!==a){var s=a.width,l=a.height,c=function(t,n,r){var i=n;if(i<8||i>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(i!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");var o=new Uint8Array(4*n*r);if(!o.length)return e(4,"unable to allocate buffer space");for(var a=0,s=0,l=4*i,u=new Uint8Array(4),c=new Uint8Array(l),p=r;p>0&&s<t.byteLength;){if(s+4>t.byteLength)return e(1);if(u[0]=t[s++],u[1]=t[s++],u[2]=t[s++],u[3]=t[s++],2!=u[0]||2!=u[1]||(u[2]<<8|u[3])!=i)return e(3,"bad rgbe scanline format");for(var d=0,h=void 0;d<l&&s<t.byteLength;){var v=(h=t[s++])>128;if(v&&(h-=128),0===h||d+h>l)return e(3,"bad scanline data");if(v)for(var f=t[s++],m=0;m<h;m++)c[d++]=f;else c.set(t.subarray(s,s+h),d),d+=h,s+=h}for(var b=i,_=0;_<b;_++){var g=0;o[a]=c[_+g],g+=i,o[a+1]=c[_+g],g+=i,o[a+2]=c[_+g],g+=i,o[a+3]=c[_+g],a+=4}p--}return o}(o.subarray(o.pos),s,l);if(-1!==c){var p,d,h,v;switch(this.type){case u.VzW:v=c.length/4;for(var f=new Float32Array(3*v),m=0;m<v;m++)r(c,4*m,f,3*m);p=f,d=u.UCm,h=u.VzW;break;case u.cLu:v=c.length/4;for(var b=new Uint16Array(3*v),_=0;_<v;_++)i(c,4*_,b,3*_);p=b,d=u.UCm,h=u.cLu;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:s,height:l,data:p,header:a.string,gamma:a.gamma,exposure:a.exposure,format:d,type:h}}}return null}},{key:"setDataType",value:function(t){return this.type=t,this}},{key:"load",value:function(t,e,r,i){return(0,o.Z)((0,a.Z)(n.prototype),"load",this).call(this,t,(function(t,n){switch(t.type){case u.VzW:case u.cLu:t.encoding=u.rnI,t.minFilter=u.wem,t.magFilter=u.wem,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,n)}),r,i)}}]),n}(u.yxD)},5413:function(t,e,n){"use strict";n.d(e,{A:function(){return c}});var r=n(5671),i=n(3144),o=n(136),a=n(9388),s=n(3562),l=n(6531),u={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\n\t\tvarying vec2 vUv;\n\n\t\tuniform sampler2D tColor;\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float maxblur; // max blur amount\n\t\tuniform float aperture; // aperture - bigger values for shallower depth of field\n\n\t\tuniform float nearClip;\n\t\tuniform float farClip;\n\n\t\tuniform float focus;\n\t\tuniform float aspect;\n\n\t\t#include <packing>\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, nearClip, farClip );\n\t\t\t#endif\n\t\t}\n\n\n\t\tvoid main() {\n\n\t\t\tvec2 aspectcorrect = vec2( 1.0, aspect );\n\n\t\t\tfloat viewZ = getViewZ( getDepth( vUv ) );\n\n\t\t\tfloat factor = ( focus + viewZ ); // viewZ is <= 0, so this is a difference equation\n\n\t\t\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );\n\n\t\t\tvec2 dofblur9 = dofblur * 0.9;\n\t\t\tvec2 dofblur7 = dofblur * 0.7;\n\t\t\tvec2 dofblur4 = dofblur * 0.4;\n\n\t\t\tvec4 col = vec4( 0.0 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );\n\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\n\t\t\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );\n\n\t\t\tgl_FragColor = col / 41.0;\n\t\t\tgl_FragColor.a = 1.0;\n\n\t\t}"},c=function(t){(0,o.Z)(n,t);var e=(0,a.Z)(n);function n(t,i,o){var a;(0,r.Z)(this,n),(a=e.call(this)).scene=t,a.camera=i;var c=void 0!==o.focus?o.focus:1,p=void 0!==o.aspect?o.aspect:i.aspect,d=void 0!==o.aperture?o.aperture:.025,h=void 0!==o.maxblur?o.maxblur:1,v=o.width||window.innerWidth||1,f=o.height||window.innerHeight||1;a.renderTargetDepth=new s.dd2(v,f,{minFilter:s.TyD,magFilter:s.TyD}),a.renderTargetDepth.texture.name="BokehPass.depth",a.materialDepth=new s.lRF,a.materialDepth.depthPacking=s.mSO,a.materialDepth.blending=s.jFi,void 0===u&&console.error("THREE.BokehPass relies on BokehShader");var m=u,b=s.rDY.clone(m.uniforms);return b.tDepth.value=a.renderTargetDepth.texture,b.focus.value=c,b.aspect.value=p,b.aperture.value=d,b.maxblur.value=h,b.nearClip.value=i.near,b.farClip.value=i.far,a.materialBokeh=new s.jyz({defines:Object.assign({},m.defines),uniforms:b,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}),a.uniforms=b,a.needsSwap=!1,a.fsQuad=new l.T(a.materialBokeh),a._oldClearColor=new s.Ilk,a}return(0,i.Z)(n,[{key:"render",value:function(t,e,n){this.scene.overrideMaterial=this.materialDepth,t.getClearColor(this._oldClearColor);var r=t.getClearAlpha(),i=t.autoClear;t.autoClear=!1,t.setClearColor(16777215),t.setClearAlpha(1),t.setRenderTarget(this.renderTargetDepth),t.clear(),t.render(this.scene,this.camera),this.uniforms.tColor.value=n.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),t.clear(),this.fsQuad.render(t)),this.scene.overrideMaterial=null,t.setClearColor(this._oldClearColor),t.setClearAlpha(r),t.autoClear=i}}]),n}(l.w)},1935:function(t,e,n){"use strict";n.d(e,{xC:function(){return h}});var r=n(5671),i=n(3144),o=n(3562),a=n(3500),s=n(136),l=n(9388),u=n(6531),c=function(t){(0,s.Z)(n,t);var e=(0,l.Z)(n);function n(t,i){var a;return(0,r.Z)(this,n),(a=e.call(this)).textureID=void 0!==i?i:"tDiffuse",t instanceof o.jyz?(a.uniforms=t.uniforms,a.material=t):t&&(a.uniforms=o.rDY.clone(t.uniforms),a.material=new o.jyz({defines:Object.assign({},t.defines),uniforms:a.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),a.fsQuad=new u.T(a.material),a}return(0,i.Z)(n,[{key:"render",value:function(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}}]),n}(u.w),p=function(t){(0,s.Z)(n,t);var e=(0,l.Z)(n);function n(t,i){var o;return(0,r.Z)(this,n),(o=e.call(this)).scene=t,o.camera=i,o.clear=!0,o.needsSwap=!1,o.inverse=!1,o}return(0,i.Z)(n,[{key:"render",value:function(t,e,n){var r,i,o=t.getContext(),a=t.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(r=0,i=1):(r=1,i=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,r,4294967295),a.buffers.stencil.setClear(i),a.buffers.stencil.setLocked(!0),t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),a.buffers.stencil.setLocked(!0)}}]),n}(u.w),d=function(t){(0,s.Z)(n,t);var e=(0,l.Z)(n);function n(){var t;return(0,r.Z)(this,n),(t=e.call(this)).needsSwap=!1,t}return(0,i.Z)(n,[{key:"render",value:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}]),n}(u.w),h=function(){function t(e,n){if((0,r.Z)(this,t),this.renderer=e,void 0===n){var i={minFilter:o.wem,magFilter:o.wem,format:o.wk1},s=e.getSize(new o.FM8);this._pixelRatio=e.getPixelRatio(),this._width=s.width,this._height=s.height,(n=new o.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===a.C&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===c&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new c(a.C),this.clock=new o.SUY}return(0,i.Z)(t,[{key:"swapBuffers",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}},{key:"addPass",value:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(t){var e=this.passes.indexOf(t);-1!==e&&this.passes.splice(e,1)}},{key:"isLastEnabledPass",value:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}},{key:"render",value:function(t){void 0===t&&(t=this.clock.getDelta());for(var e=this.renderer.getRenderTarget(),n=!1,r=0,i=this.passes.length;r<i;r++){var o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),o.needsSwap){if(n){var a=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),s.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==p&&(o instanceof p?n=!0:o instanceof d&&(n=!1))}}this.renderer.setRenderTarget(e)}},{key:"reset",value:function(t){if(void 0===t){var e=this.renderer.getSize(new o.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(t,e){this._width=t,this._height=e;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)}},{key:"setPixelRatio",value:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}]),t}(),v=(new o.iKG(-1,1,1,-1,0,1),new o.u9r);v.setAttribute("position",new o.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),v.setAttribute("uv",new o.a$l([0,2,0,0,2,0],2))},6531:function(t,e,n){"use strict";n.d(e,{T:function(){return u},w:function(){return a}});var r=n(5671),i=n(3144),o=n(3562),a=function(){function t(){(0,r.Z)(this,t),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return(0,i.Z)(t,[{key:"setSize",value:function(){}},{key:"render",value:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}]),t}(),s=new o.iKG(-1,1,1,-1,0,1),l=new o.u9r;l.setAttribute("position",new o.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new o.a$l([0,2,0,0,2,0],2));var u=function(){function t(e){(0,r.Z)(this,t),this._mesh=new o.Kj0(l,e)}return(0,i.Z)(t,[{key:"dispose",value:function(){this._mesh.geometry.dispose()}},{key:"render",value:function(t){t.render(this._mesh,s)}},{key:"material",get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}]),t}()},6938:function(t,e,n){"use strict";n.d(e,{C:function(){return l}});var r=n(5671),i=n(3144),o=n(136),a=n(9388),s=n(3562),l=function(t){(0,o.Z)(n,t);var e=(0,a.Z)(n);function n(t,i,o,a,l){var u;return(0,r.Z)(this,n),(u=e.call(this)).scene=t,u.camera=i,u.overrideMaterial=o,u.clearColor=a,u.clearAlpha=void 0!==l?l:0,u.clear=!0,u.clearDepth=!1,u.needsSwap=!1,u._oldClearColor=new s.Ilk,u}return(0,i.Z)(n,[{key:"render",value:function(t,e,n){var r,i,o=t.autoClear;t.autoClear=!1,void 0!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t.getClearColor(this._oldClearColor),r=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:n),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(this._oldClearColor,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=i),t.autoClear=o}}]),n}(n(6531).w)},3500:function(t,e,n){"use strict";n.d(e,{C:function(){return r}});var r={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"}}}]);